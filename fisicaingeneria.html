<!DOCTYPE html>
<html lang="es" data-theme="light">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Banco de F√≠sica UPC</title>

  <!-- FONTS -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@500;700&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet">

  <!-- MATHJAX -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$']],
        processEscapes: true,
        tags: 'ams'
      },
      options: {
        renderActions: { addMenu: [] }
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    /* 
        ========================================
        1. VARIABLES & THEME CONFIGURATION
        ========================================
        */
    :root {
      /* Dimensions */
      --sidebar-width: 280px;
      --header-height: 70px;
      --card-radius: 16px;
      --modal-radius: 24px;

      /* Typography */
      --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
      --font-display: 'Space Grotesk', sans-serif;
      --font-mono: 'JetBrains Mono', monospace;

      /* Animations */
      --ease-out: cubic-bezier(0.215, 0.61, 0.355, 1);
      --ease-in-out: cubic-bezier(0.645, 0.045, 0.355, 1);
      --duration-fast: 0.2s;
      --duration-normal: 0.4s;
      --duration-slow: 0.6s;
    }

    [data-theme="dark"] {
      /* Backgrounds */
      --bg-app: #050505;
      --bg-sidebar: #0a0a0a;
      --bg-card: #111111;
      --bg-card-hover: #161616;
      --bg-modal: #0f0f0f;
      --bg-input: #1a1a1a;

      /* Text */
      --text-primary: #ffffff;
      --text-secondary: #a1a1aa;
      --text-tertiary: #52525b;

      /* Borders */
      --border-light: rgba(255, 255, 255, 0.06);
      --border-hover: rgba(255, 255, 255, 0.12);

      /* Accents */
      --accent-primary: #6366f1;
      /* Indigo */
      --accent-secondary: #8b5cf6;
      /* Violet */
      --accent-success: #10b981;
      /* Emerald */
      --accent-warning: #f59e0b;
      /* Amber */
      --accent-danger: #ef4444;
      /* Red */

      /* Shadows */
      --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.3);
      --shadow-md: 0 8px 16px rgba(0, 0, 0, 0.4);
      --shadow-lg: 0 24px 48px rgba(0, 0, 0, 0.6);
      --glow-primary: 0 0 20px rgba(99, 102, 241, 0.15);
    }

    [data-theme="light"] {
      /* Backgrounds */
      --bg-app: #f8fafc;
      --bg-sidebar: #ffffff;
      --bg-card: #ffffff;
      --bg-card-hover: #f1f5f9;
      --bg-modal: #ffffff;
      --bg-input: #f1f5f9;

      /* Text */
      --text-primary: #0f172a;
      --text-secondary: #64748b;
      --text-tertiary: #94a3b8;

      /* Borders */
      --border-light: rgba(0, 0, 0, 0.06);
      --border-hover: rgba(0, 0, 0, 0.1);

      /* Accents */
      --accent-primary: #4f46e5;
      --accent-secondary: #7c3aed;
      --accent-success: #059669;
      --accent-warning: #d97706;
      --accent-danger: #dc2626;

      /* Shadows */
      --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.05);
      --shadow-md: 0 8px 16px rgba(0, 0, 0, 0.08);
      --shadow-lg: 0 24px 48px rgba(0, 0, 0, 0.12);
      --glow-primary: 0 0 20px rgba(79, 70, 229, 0.1);
    }

    /* 
        ========================================
        2. RESET & UTILITIES
        ========================================
        */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      outline: none;
    }

    body {
      font-family: var(--font-sans);
      background-color: var(--bg-app);
      color: var(--text-primary);
      height: 100vh;
      overflow: hidden;
      display: flex;
      transition: background-color var(--duration-normal) var(--ease-out);
    }

    a {
      text-decoration: none;
      color: inherit;
    }

    button {
      border: none;
      background: none;
      cursor: pointer;
      font-family: inherit;
    }

    ul {
      list-style: none;
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border-hover);
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--text-tertiary);
    }

    /* Typography Utilities */
    .h1 {
      font-family: var(--font-display);
      font-size: 2.5rem;
      font-weight: 700;
      letter-spacing: -0.02em;
      line-height: 1.1;
    }

    .h2 {
      font-family: var(--font-display);
      font-size: 1.75rem;
      font-weight: 700;
      letter-spacing: -0.01em;
    }

    .h3 {
      font-family: var(--font-display);
      font-size: 1.25rem;
      font-weight: 600;
    }

    .text-sm {
      font-size: 0.875rem;
    }

    .text-xs {
      font-size: 0.75rem;
    }

    .font-mono {
      font-family: var(--font-mono);
    }

    .text-muted {
      color: var(--text-secondary);
    }

    /* 
        ========================================
        3. SIDEBAR NAVIGATION
        ========================================
        */
    .sidebar {
      width: var(--sidebar-width);
      height: 100%;
      background: var(--bg-sidebar);
      border-right: 1px solid var(--border-light);
      display: flex;
      flex-direction: column;
      padding: 24px;
      z-index: 10;
      transition: transform var(--duration-normal) var(--ease-out);
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 40px;
      padding-left: 12px;
    }

    .brand-logo {
      width: 36px;
      height: 36px;
      background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
      border-radius: 10px;
      display: grid;
      place-items: center;
      font-weight: 700;
      color: white;
      font-size: 1.2rem;
      box-shadow: var(--glow-primary);
    }

    .brand-text {
      font-family: var(--font-display);
      font-size: 1.25rem;
      font-weight: 700;
      letter-spacing: -0.02em;
    }

    .nav-menu {
      display: flex;
      flex-direction: column;
      gap: 8px;
      flex-grow: 1;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      border-radius: 12px;
      color: var(--text-secondary);
      font-weight: 500;
      transition: all var(--duration-fast);
    }

    .nav-item:hover {
      background: var(--bg-input);
      color: var(--text-primary);
    }

    .nav-item.active {
      background: rgba(99, 102, 241, 0.1);
      color: var(--accent-primary);
    }

    .nav-icon {
      width: 20px;
      height: 20px;
      opacity: 0.7;
    }

    .sidebar-footer {
      margin-top: auto;
      padding-top: 24px;
      border-top: 1px solid var(--border-light);
    }

    .stats-card {
      background: var(--bg-input);
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 16px;
    }

    .stat-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 0.85rem;
    }

    .progress-bar {
      width: 100%;
      height: 4px;
      background: var(--border-hover);
      border-radius: 2px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: var(--accent-success);
      width: 0%;
      transition: width 1s var(--ease-out);
    }

    /* 
        ========================================
        4. MAIN CONTENT AREA
        ========================================
        */
    .main-content {
      flex-grow: 1;
      height: 100%;
      overflow-y: auto;
      padding: 40px 60px;
      position: relative;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      margin-bottom: 40px;
      animation: slideDown 0.6s var(--ease-out);
    }

    .header-content h1 {
      margin-bottom: 8px;
    }

    .header-content p {
      max-width: 600px;
      line-height: 1.6;
    }

    .header-actions {
      display: flex;
      gap: 16px;
    }

    .theme-btn {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      border: 1px solid var(--border-light);
      display: grid;
      place-items: center;
      color: var(--text-secondary);
      transition: all var(--duration-fast);
    }

    .theme-btn:hover {
      background: var(--bg-card-hover);
      color: var(--text-primary);
      border-color: var(--border-hover);
    }

    /* Filter Bar */
    .filter-bar {
      display: flex;
      gap: 12px;
      margin-bottom: 32px;
      overflow-x: auto;
      padding-bottom: 4px;
      animation: fadeIn 0.8s var(--ease-out);
    }

    .filter-chip {
      padding: 8px 16px;
      border-radius: 100px;
      border: 1px solid var(--border-light);
      background: var(--bg-card);
      color: var(--text-secondary);
      font-size: 0.875rem;
      font-weight: 500;
      white-space: nowrap;
      transition: all var(--duration-fast);
    }

    .filter-chip:hover {
      border-color: var(--accent-primary);
      color: var(--text-primary);
    }

    .filter-chip.active {
      background: var(--accent-primary);
      border-color: var(--accent-primary);
      color: white;
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
    }

    /* 
        ========================================
        5. EXERCISE GRID & CARDS
        ========================================
        */
    .exercise-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 24px;
      padding-bottom: 60px;
    }

    .exercise-card {
      background: var(--bg-card);
      border: 1px solid var(--border-light);
      border-radius: var(--card-radius);
      padding: 24px;
      display: flex;
      flex-direction: column;
      transition: all var(--duration-fast);
      cursor: pointer;
      position: relative;
      overflow: hidden;
      animation: fadeInUp 0.6s var(--ease-out) backwards;
    }

    .exercise-card:hover {
      transform: translateY(-4px);
      border-color: var(--border-hover);
      box-shadow: var(--shadow-md);
      background: var(--bg-card-hover);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 16px;
    }

    .card-badges {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .badge {
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .badge-diff-easy {
      background: rgba(16, 185, 129, 0.1);
      color: var(--accent-success);
    }

    .badge-diff-medium {
      background: rgba(245, 158, 11, 0.1);
      color: var(--accent-warning);
    }

    .badge-diff-hard {
      background: rgba(239, 68, 68, 0.1);
      color: var(--accent-danger);
    }

    .badge-topic {
      background: var(--bg-input);
      color: var(--text-secondary);
      border: 1px solid var(--border-light);
    }

    .card-id {
      font-family: var(--font-mono);
      font-size: 0.75rem;
      color: var(--text-tertiary);
    }

    .card-body {
      flex-grow: 1;
      margin-bottom: 20px;
    }

    .problem-preview {
      font-size: 1rem;
      line-height: 1.6;
      color: var(--text-primary);
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .card-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 16px;
      border-top: 1px solid var(--border-light);
    }

    .view-sol-btn {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--accent-primary);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .view-sol-btn::after {
      content: '‚Üí';
      transition: transform 0.2s;
    }

    .exercise-card:hover .view-sol-btn::after {
      transform: translateX(4px);
    }

    /* 
        ========================================
        6. FULL SCREEN MODAL
        ========================================
        */
    .modal-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(8px);
      z-index: 1000;
      display: none;
      opacity: 0;
      transition: opacity var(--duration-normal);
    }

    .modal-backdrop.active {
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 1;
    }

    .modal-content {
      width: 90%;
      max-width: 1000px;
      height: 90%;
      background: var(--bg-modal);
      border-radius: var(--modal-radius);
      border: 1px solid var(--border-light);
      box-shadow: var(--shadow-lg);
      display: flex;
      flex-direction: column;
      transform: scale(0.95) translateY(20px);
      transition: transform var(--duration-normal) var(--ease-out);
      overflow: hidden;
    }

    .modal-backdrop.active .modal-content {
      transform: scale(1) translateY(0);
    }

    .modal-header {
      padding: 24px 32px;
      border-bottom: 1px solid var(--border-light);
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--bg-card);
    }

    .modal-title-group h2 {
      margin-bottom: 4px;
    }

    .modal-subtitle {
      font-family: var(--font-mono);
      color: var(--text-tertiary);
      font-size: 0.9rem;
    }

    .close-modal-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--bg-input);
      color: var(--text-secondary);
      display: grid;
      place-items: center;
      font-size: 1.2rem;
      transition: all 0.2s;
    }

    .close-modal-btn:hover {
      background: var(--accent-danger);
      color: white;
      transform: rotate(90deg);
    }

    .modal-body {
      flex-grow: 1;
      overflow-y: auto;
      padding: 40px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
    }

    .problem-section {
      padding-right: 40px;
      border-right: 1px solid var(--border-light);
    }

    .solution-section {
      padding-left: 10px;
    }

    .section-label {
      font-family: var(--font-mono);
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--accent-primary);
      margin-bottom: 16px;
      display: block;
    }

    .problem-text {
      font-size: 1.25rem;
      line-height: 1.7;
      margin-bottom: 32px;
    }

    .step-card {
      background: var(--bg-input);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      border-left: 3px solid var(--accent-secondary);
      animation: slideInRight 0.5s var(--ease-out) backwards;
    }

    .step-number {
      font-family: var(--font-mono);
      font-size: 0.8rem;
      color: var(--text-secondary);
      margin-bottom: 8px;
      display: block;
    }

    .final-answer {
      margin-top: 40px;
      padding: 24px;
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid var(--accent-success);
      border-radius: 12px;
      text-align: center;
    }

    .final-label {
      color: var(--accent-success);
      font-weight: 700;
      text-transform: uppercase;
      font-size: 0.8rem;
      margin-bottom: 12px;
      display: block;
    }

    /* 
        ========================================
        7. ANIMATIONS
        ========================================
        */
    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(20px);
      }

      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .sidebar {
        width: 80px;
        padding: 16px;
      }

      .brand-text,
      .nav-text,
      .stats-card {
        display: none;
      }

      .brand {
        justify-content: center;
        padding: 0;
      }

      .nav-item {
        justify-content: center;
        padding: 16px;
      }

      .main-content {
        padding: 20px;
      }

      .modal-body {
        grid-template-columns: 1fr;
      }

      .problem-section {
        border-right: none;
        border-bottom: 1px solid var(--border-light);
        padding-bottom: 30px;
        margin-bottom: 30px;
        padding-right: 0;
      }

      .solution-section {
        padding-left: 0;
      }
    }
  </style>
</head>

<body>

  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="brand">
      <div class="brand-logo">Œ¶</div>
      <span class="brand-text">UPC Physics</span>
    </div>

    <nav class="nav-menu">
      <button class="nav-item active" onclick="filterExercises('all')">
        <span class="nav-icon">‚ö°</span>
        <span class="nav-text">Todo</span>
      </button>
      <button class="nav-item" onclick="filterExercises('f1')">
        <span class="nav-icon">ü™ê</span>
        <span class="nav-text">F√≠sica I</span>
      </button>
      <button class="nav-item" onclick="filterExercises('f2')">
        <span class="nav-icon">üß≤</span>
        <span class="nav-text">F√≠sica II</span>
      </button>
    </nav>

    <div class="sidebar-footer">
      <div class="stats-card">
        <div class="stat-row">
          <span>Progreso Semestral</span>
          <span>100%</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" style="width: 100%"></div>
        </div>
      </div>
    </div>
  </aside>

  <!-- MAIN CONTENT -->
  <main class="main-content">
    <header class="header">
      <div class="header-content">
        <h1 class="h1">Banco de F√≠sica UPC</h1>
        <p class="text-muted">Ejercicios de nivel parcial para Ingenier√≠a F√≠sica. Incluye Cinem√°tica, Din√°mica,
          Electromagnetismo y Cu√°ntica.</p>
      </div>
      <div class="header-actions">
        <button class="theme-btn" onclick="toggleTheme()" aria-label="Toggle Theme">
          <span id="theme-icon">‚òÄÔ∏è</span>
        </button>
      </div>
    </header>

    <div class="filter-bar" id="topic-filters">
      <!-- Populated by JS -->
    </div>

    <div class="exercise-grid" id="grid">
      <!-- Populated by JS -->
      <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: var(--text-secondary);">
        Cargando ejercicios...
      </div>
    </div>
  </main>

  <!-- MODAL -->
  <div class="modal-backdrop" id="modal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title-group">
          <h2 class="h2" id="modal-title">T√≠tulo del Problema</h2>
          <span class="modal-subtitle" id="modal-id">ID: C1-001</span>
        </div>
        <button class="close-modal-btn" onclick="closeModal()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="problem-section">
          <span class="section-label">Enunciado</span>
          <div class="problem-text" id="modal-problem">
            <!-- LaTeX Problem -->
          </div>
          <div class="tags" id="modal-tags">
            <!-- Tags -->
          </div>
        </div>
        <div class="solution-section" id="modal-steps">
          <span class="section-label">Soluci√≥n Paso a Paso</span>
          <!-- Steps injected here -->
        </div>
      </div>
    </div>
  </div>

  <script>
    const exercises = [
      // ============================================================
      // F√çSICA I: MEC√ÅNICA Y ONDAS (25 EJERCICIOS)
      // ============================================================
      {
        id: "F1-001",
        category: "f1",
        topic: "Cinem√°tica (Tiro Parab√≥lico)",
        difficulty: "Hard",
        problem: "Un proyectil se lanza con velocidad $v_0$ y √°ngulo $\\theta$. Existe una aceleraci√≥n horizontal debida al viento $a_x = -kv_x$. Halla la posici√≥n horizontal m√°xima.",
        steps: [
          "Ecuaciones: $a_x = -kv_x \\Rightarrow \\frac{dv_x}{dt} = -kv_x$.",
          "Integramos: $\\int_{v_{0x}}^{v_x} \\frac{dv_x}{v_x} = -kt \\Rightarrow v_x(t) = v_{0x} e^{-kt}$.",
          "Posici√≥n $x(t) = \\int_0^t v_x dt = \\frac{v_{0x}}{k}(1 - e^{-kt})$.",
          "Alcance m√°ximo asint√≥tico ($t \\to \\infty$): $x_{max} = \\frac{v_0 \\cos \\theta}{k}$."
        ],
        solution: "$$ x_{max} = \\frac{v_0 \\cos \\theta}{k} $$"
      },
      {
        id: "F1-002",
        category: "f1",
        topic: "Din√°mica (Cuerda Pesada)",
        difficulty: "Hard",
        problem: "Una cuerda de masa $M$ y longitud $L$ cuelga del borde de una mesa. Si empieza a caer desde el reposo con una longitud $y_0$ colgando, halla la velocidad cuando abandona la mesa.",
        steps: [
          "Masa colgante $m(y) = \\frac{M}{L}y$. Fuerza $F = m(y)g = \\frac{Mg}{L}y$.",
          "Newton: $M a = \\frac{Mg}{L}y \\Rightarrow v \\frac{dv}{dy} = \\frac{g}{L}y$.",
          "Integramos: $\\int_0^v v dv = \\frac{g}{L} \\int_{y_0}^L y dy$.",
          "$v = \\sqrt{\\frac{g}{L}(L^2 - y_0^2)}$."
        ],
        solution: "$$ v = \\sqrt{gL(1 - (y_0/L)^2)} $$"
      },
      {
        id: "F1-003",
        category: "f1",
        topic: "Energ√≠a (Pozo Potencial)",
        difficulty: "Medium",
        problem: "Una part√≠cula se mueve en $U(x) = x^4 - 2x^2$. Halla los puntos de equilibrio y su estabilidad.",
        steps: [
          "Fuerza $F = -dU/dx = -(4x^3 - 4x)$.",
          "Equilibrio $F=0 \\Rightarrow 4x(x^2-1) = 0$. Puntos $x=0, 1, -1$.",
          "$U''(x) = 12x^2 - 4$.",
          "$U''(0) = -4 < 0$ (Inestable). $U''(\\pm 1) = 8 > 0$ (Estables)."
        ],
        solution: "$$ 0 \\text{ (Inest)}, \\pm 1 \\text{ (Est)} $$"
      },
      {
        id: "F1-004",
        category: "f1",
        topic: "Cohete (Masa Variable)",
        difficulty: "Hard",
        problem: "Un cohete en el espacio libre expulsa gas a velocidad relativa $u$. Halla la velocidad final si la masa inicial es $M_0$ y la final $M_f$.",
        steps: [
          "Ecuaci√≥n Tsiolkovsky: $m dv = -u dm$.",
          "$\\int_0^v dv = -u \\int_{M_0}^{M_f} \\frac{dm}{m}$.",
          "$v = -u \\ln(M_f/M_0) = u \\ln(M_0/M_f)$."
        ],
        solution: "$$ v = u \\ln\\frac{M_0}{M_f} $$"
      },
      {
        id: "F1-005",
        category: "f1",
        topic: "Ondas (Cuerda Vibrante)",
        difficulty: "Medium",
        problem: "Halla la velocidad de propagaci√≥n de una onda en una cuerda de densidad $\\mu$ bajo tensi√≥n $T$.",
        steps: [
          "Newton en elemento $dx$: $(\\mu dx) \\frac{\\partial^2 y}{\\partial t^2} = T \\frac{\\partial^2 y}{\\partial x^2} dx$.",
          "Ec. Onda: $\\frac{\\partial^2 y}{\\partial t^2} = \\frac{T}{\\mu} \\frac{\\partial^2 y}{\\partial x^2}$.",
          "$v^2 = T/\\mu$."
        ],
        solution: "$$ v = \\sqrt{T/\\mu} $$"
      },
      {
        id: "F1-006",
        category: "f1",
        topic: "Momento Angular",
        difficulty: "Medium",
        problem: "Demuestra que en un campo de fuerza central $\\vec{F} = f(r)\\hat{r}$, el momento angular se conserva.",
        steps: [
          "Torque $\\vec{\\tau} = \\vec{r} \\times \\vec{F}$.",
          "$\\vec{\\tau} = \\vec{r} \\times (f(r)\\frac{\\vec{r}}{r}) = 0$ (producto cruz de vectores paralelos).",
          "$\\frac{d\\vec{L}}{dt} = \\vec{\\tau} = 0 \\Rightarrow \\vec{L} = \\text{cte}$."
        ],
        solution: "$$ \\vec{L} = \\text{constante} $$"
      },
      {
        id: "F1-007",
        category: "f1",
        topic: "Colisiones 2D",
        difficulty: "Hard",
        problem: "Una part√≠cula de masa $m$ choca el√°sticamente con otra de masa $m$ en reposo. Demuestra que salen a 90¬∞.",
        steps: [
          "Conservaci√≥n momento: $\\vec{p}_i = \\vec{p}_1 + \\vec{p}_2$. Cuadrado: $p_i^2 = p_1^2 + p_2^2 + 2\\vec{p}_1\\cdot\\vec{p}_2$.",
          "Energ√≠a: $p_i^2 = p_1^2 + p_2^2$.",
          "Comparando: $2\\vec{p}_1\\cdot\\vec{p}_2 = 0 \\implies$ perpendiculares."
        ],
        solution: "$$ \\theta = 90^\\circ $$"
      },
      {
        id: "F1-008",
        category: "f1",
        topic: "Oscilador Amortiguado",
        difficulty: "Hard",
        problem: "Resuelve $\\ddot{x} + 2\\gamma \\dot{x} + \\omega_0^2 x = 0$ para el caso cr√≠tico $\\gamma = \\omega_0$.",
        steps: [
          "Ec. caracter√≠stica: $(r+\\gamma)^2 = 0$. Ra√≠z doble $r = -\\gamma$.",
          "Soluci√≥n general: $x(t) = (A + Bt)e^{-\\gamma t}$."
        ],
        solution: "$$ x(t) = (C_1 + C_2 t)e^{-\\omega_0 t} $$"
      },
      {
        id: "F1-009",
        category: "f1",
        topic: "Momento de Inercia",
        difficulty: "Medium",
        problem: "Calcula el momento de inercia de una varilla de longitud $L$ respecto a un extremo.",
        steps: [
          "$I = \\int_0^L x^2 (\\frac{M}{L} dx) = \\frac{M}{L} [\\frac{x^3}{3}]_0^L$.",
          "$I = \\frac{M}{L} \\frac{L^3}{3} = \\frac{1}{3}ML^2$."
        ],
        solution: "$$ \\frac{1}{3}ML^2 $$"
      },
      {
        id: "F1-010",
        category: "f1",
        topic: "Trabajo (Fuerza Variable)",
        difficulty: "Medium",
        problem: "Trabajo realizado por $\\vec{F} = (xy, x^2)$ a lo largo de $y=x^2$ desde $(0,0)$ a $(1,1)$.",
        steps: [
          "Parametrizamos: $x=t, y=t^2$. $d\\vec{r} = (1, 2t)dt$.",
          "$\\vec{F}\\cdot d\\vec{r} = (t^3 + 2t^3)dt = 3t^3 dt$.",
          "$W = \\int_0^1 3t^3 dt = 3/4$."
        ],
        solution: "$$ 0.75 \\text{ J} $$"
      },
      {
        id: "F1-011",
        category: "f1",
        topic: "P√©ndulo F√≠sico",
        difficulty: "Medium",
        problem: "Periodo de oscilaci√≥n de un disco de radio $R$ colgado de un punto en su borde.",
        steps: [
          "Steiner: $I = I_{cm} + MR^2 = \\frac{3}{2}MR^2$.",
          "$T = 2\\pi \\sqrt{I/mgR} = 2\\pi \\sqrt{\\frac{3R}{2g}}$."
        ],
        solution: "$$ 2\\pi \\sqrt{1.5 R/g} $$"
      },
      {
        id: "F1-012",
        category: "f1",
        topic: "Bernoulli (Fluidos)",
        difficulty: "Medium",
        problem: "Velocidad de salida de agua por un orificio a profundidad $h$ (Teorema Torricelli).",
        steps: [
          "Bernoulli: $P_{atm} + \\rho g h = P_{atm} + \\frac{1}{2}\\rho v^2$.",
          "$v = \\sqrt{2gh}$."
        ],
        solution: "$$ \\sqrt{2gh} $$"
      },
      {
        id: "F1-013",
        category: "f1",
        topic: "Termodin√°mica (Adiab√°tico)",
        difficulty: "Hard",
        problem: "Trabajo en expansi√≥n adiab√°tica de $V_1$ a $V_2$.",
        steps: [
          "$P = K V^{-\\gamma}$. $W = \\int P dV$.",
          "$W = \\frac{P_2 V_2 - P_1 V_1}{1-\\gamma}$."
        ],
        solution: "$$ \\frac{P_2 V_2 - P_1 V_1}{1-\\gamma} $$"
      },
      {
        id: "F1-014",
        category: "f1",
        topic: "Cinem√°tica Polar",
        difficulty: "Hard",
        problem: "Expresi√≥n de la velocidad en coordenadas polares.",
        steps: [
          "$\\vec{r} = r \\hat{u}_r$. Derivamos: $\\vec{v} = \\dot{r}\\hat{u}_r + r \\dot{\\hat{u}}_r$.",
          "$\\dot{\\hat{u}}_r = \\dot{\\theta}\\hat{u}_\\theta$.",
          "$\\vec{v} = \\dot{r}\\hat{u}_r + r\\dot{\\theta}\\hat{u}_\\theta$."
        ],
        solution: "$$ \\dot{r}\\hat{u}_r + r\\dot{\\theta}\\hat{u}_\\theta $$"
      },
      {
        id: "F1-015",
        category: "f1",
        topic: "Coriolis (Ca√≠da Libre)",
        difficulty: "Hard",
        problem: "Desviaci√≥n de un objeto que cae desde altura $h$ en el ecuador.",
        steps: [
          "$a_c = 2\\omega g t$ (hacia el Este).",
          "Integrando dos veces: $x = \\frac{1}{3}\\omega g t^3$. $t=\\sqrt{2h/g}$."
        ],
        solution: "$$ \\frac{2}{3}\\omega h \\sqrt{\\frac{2h}{g}} \\text{ Este} $$"
      },
      {
        id: "F1-016",
        category: "f1",
        topic: "Centro de Masas",
        difficulty: "Medium",
        problem: "CM de un semic√≠rculo homog√©neo de radio $R$.",
        steps: [
          "$y_{cm} = \\frac{1}{A} \\int y dA$. Polares: $\\int r^2 dr \\int \\sin\\theta d\\theta$.",
          "$y_{cm} = \\frac{4R}{3\\pi}$."
        ],
        solution: "$$ 4R/3\\pi $$"
      },
      {
        id: "F1-017",
        category: "f1",
        topic: "Energ√≠a Potencial Efectiva",
        difficulty: "Hard",
        problem: "Halla el radio de la √≥rbita circular estable para potencial $V(r) = -k/r$.",
        steps: [
          "$V'_{eff} = -\\frac{L^2}{mr^3} + \\frac{k}{r^2} = 0$.",
          "$r = \\frac{L^2}{mk}$."
        ],
        solution: "$$ r_0 = L^2/mk $$"
      },
      {
        id: "F1-018",
        category: "f1",
        topic: "Ondas Estacionarias",
        difficulty: "Medium",
        problem: "Frecuencias permitidas en un tubo abierto por ambos extremos.",
        steps: [
          "$L = n \\frac{\\lambda}{2}$.",
          "$f = v/\\lambda = n \\frac{v}{2L}$."
        ],
        solution: "$$ f_n = n \\frac{v}{2L} $$"
      },
      {
        id: "F1-019",
        category: "f1",
        topic: "Rodadura",
        difficulty: "Medium",
        problem: "Aceleraci√≥n de un cilindro que rueda sin deslizar por un plano inclinado $\\theta$.",
        steps: [
          "$Mg\\sin\\theta - f_r = Ma$. $f_r = I a / R^2 = Ma/2$.",
          "$Mg\\sin\\theta = 3/2 Ma$."
        ],
        solution: "$$ a = \\frac{2}{3}g\\sin\\theta $$"
      },
      {
        id: "F1-020",
        category: "f1",
        topic: "P√©ndulo (Gran Amplitud)",
        difficulty: "Hard",
        problem: "Periodo del p√©ndulo para amplitudes grandes (correcci√≥n).",
        steps: [
          "Aprox $\\sin\\theta \\approx \\theta - \\theta^3/6$.",
          "$T = T_0 (1 + \\frac{1}{16}\\theta_0^2)$."
        ],
        solution: "$$ T_0 (1 + \\theta_0^2/16) $$"
      },
      {
        id: "F1-021",
        category: "f1",
        topic: "Interferencia Ondas",
        difficulty: "Medium",
        problem: "Amplitud resultante de $A\\sin(\\omega t)$ y $A\\sin(\\omega t + \\phi)$.",
        steps: [
          "Identidad: $\\sin a + \\sin b = 2 \\sin(\\frac{a+b}{2}) \\cos(\\frac{a-b}{2})$.",
          "Amplitud $2A \\cos(\\phi/2)$."
        ],
        solution: "$$ 2A \\cos(\\phi/2) $$"
      },
      {
        id: "F1-022",
        category: "f1",
        topic: "Gir√≥scopo",
        difficulty: "Hard",
        problem: "Velocidad de precesi√≥n de un trompo.",
        steps: [
          "Torque $\\tau = Mgh \\sin\\theta$. $dL = L \\sin\\theta d\\phi$.",
          "$\\Omega = \\frac{d\\phi}{dt} = \\frac{\\tau}{L\\sin\\theta} = \\frac{Mgh}{I\\omega}$."
        ],
        solution: "$$ \\Omega = \\frac{Mgh}{I\\omega} $$"
      },
      {
        id: "F1-023",
        category: "f1",
        topic: "M√°quina Atwood",
        difficulty: "Medium",
        problem: "Tensi√≥n en la cuerda de una m√°quina de Atwood con masas $m_1, m_2$.",
        steps: [
          "$a = g\\frac{m_2-m_1}{m_1+m_2}$.",
          "$T = m_1(g+a) = \\frac{2m_1 m_2 g}{m_1+m_2}$."
        ],
        solution: "$$ \\frac{2m_1 m_2 g}{m_1+m_2} $$"
      },
      {
        id: "F1-024",
        category: "f1",
        topic: "Energ√≠a Rodadura",
        difficulty: "Medium",
        problem: "Energ√≠a cin√©tica de una esfera rodando.",
        steps: [
          "$K = \\frac{1}{2}Mv^2 + \\frac{1}{2}(\\frac{2}{5}MR^2)(v/R)^2 = \\frac{7}{10}Mv^2$."
        ],
        solution: "$$ 0.7 Mv^2 $$"
      },
      {
        id: "F1-025",
        category: "f1",
        topic: "Momento (Explosi√≥n)",
        difficulty: "Medium",
        problem: "Objeto explota en 3. Dos salen a 90¬∞ con momento $p$. Halla el tercero.",
        steps: [
          "$\\vec{p}_3 = -(\\vec{p}_1 + \\vec{p}_2)$.",
          "$p_3 = \\sqrt{p^2+p^2} = p\\sqrt{2}$."
        ],
        solution: "$$ p\\sqrt{2} $$"
      },
      // ============================================================
      // F√çSICA II: CAMPOS Y CU√ÅNTICA (25 EJERCICIOS)
      // ============================================================
      {
        id: "F2-001",
        category: "f2",
        topic: "Campo El√©ctrico (Anillo)",
        difficulty: "Medium",
        problem: "Campo el√©ctrico en el eje de un anillo cargado con $Q$ y radio $R$ a distancia $z$.",
        steps: [
          "$dE_z = dE \\cos\\theta$. $E_z = \\int \\frac{k z dq}{(R^2+z^2)^{3/2}}$.",
          "$E_z = \\frac{kQz}{(R^2+z^2)^{3/2}}$."
        ],
        solution: "$$ \\frac{kQz}{(R^2+z^2)^{3/2}} $$"
      },
      {
        id: "F2-002",
        category: "f2",
        topic: "Potencial El√©ctrico (Disco)",
        difficulty: "Hard",
        problem: "Potencial en el eje de un disco cargado uniformemente con $\\sigma$.",
        steps: [
          "$dV = \\frac{k \\sigma 2\\pi r dr}{\\sqrt{r^2+z^2}}$.",
          "$V = 2\\pi k \\sigma [\\sqrt{R^2+z^2} - z]$."
        ],
        solution: "$$ \\frac{\\sigma}{2\\epsilon_0}(\\sqrt{R^2+z^2}-z) $$"
      },
      {
        id: "F2-003",
        category: "f2",
        topic: "Gauss (Esfera No Uniforme)",
        difficulty: "Hard",
        problem: "Campo el√©ctrico dentro de una esfera con densidad $\\rho(r) = Ar$.",
        steps: [
          "$Q(r) = \\int_0^r Ar' 4\\pi r'^2 dr' = \\pi A r^4$.",
          "$E(4\\pi r^2) = \\pi A r^4 / \\epsilon_0 \\Rightarrow E = \\frac{A r^2}{4\\epsilon_0}$."
        ],
        solution: "$$ \\frac{A r^2}{4\\epsilon_0} $$"
      },
      {
        id: "F2-004",
        category: "f2",
        topic: "Dipolo El√©ctrico",
        difficulty: "Medium",
        problem: "Potencial de un dipolo $\\vec{p}$ a gran distancia.",
        steps: [
          "$V \\approx \\frac{kq d \\cos\\theta}{r^2} = \\frac{k \\vec{p}\\cdot\\hat{r}}{r^2}$."
        ],
        solution: "$$ \\frac{k \\vec{p}\\cdot\\vec{r}}{r^3} $$"
      },
      {
        id: "F2-005",
        category: "f2",
        topic: "Condensador (Diel√©ctrico)",
        difficulty: "Medium",
        problem: "Capacidad de un condensador plano con diel√©ctrico de espesor $d/2$.",
        steps: [
          "Serie: $C_1$ (aire), $C_2$ (diel√©ctrico).",
          "$C_{eq} = \\frac{2\\epsilon_0 A}{d} \\frac{K}{K+1}$."
        ],
        solution: "$$ \\frac{2K}{K+1} C_0 $$"
      },
      {
        id: "F2-006",
        category: "f2",
        topic: "Energ√≠a Electrost√°tica",
        difficulty: "Hard",
        problem: "Energ√≠a almacenada en una esfera cargada uniformemente $Q$.",
        steps: [
          "$U = \\frac{\\epsilon_0}{2} \\int E^2 dV$.",
          "$U = \\frac{3}{5} \\frac{kQ^2}{R}$."
        ],
        solution: "$$ \\frac{3}{5} \\frac{kQ^2}{R} $$"
      },
      {
        id: "F2-007",
        category: "f2",
        topic: "Campo Magn√©tico (Espira)",
        difficulty: "Medium",
        problem: "Campo $B$ en el centro de una espira circular de corriente $I$.",
        steps: [
          "Biot-Savart: $B = \\int \\frac{\\mu_0 I}{4\\pi R^2} dl = \\frac{\\mu_0 I}{2R}$."
        ],
        solution: "$$ \\frac{\\mu_0 I}{2R} $$"
      },
      {
        id: "F2-008",
        category: "f2",
        topic: "Ley de Amp√®re (Cable)",
        difficulty: "Medium",
        problem: "Campo $B$ dentro de un cable de radio $R$ con corriente uniforme $I$.",
        steps: [
          "$B(2\\pi r) = \\mu_0 I (r^2/R^2)$.",
          "$B = \\frac{\\mu_0 I r}{2\\pi R^2}$."
        ],
        solution: "$$ \\frac{\\mu_0 I r}{2\\pi R^2} $$"
      },
      {
        id: "F2-009",
        category: "f2",
        topic: "Fuerza de Lorentz",
        difficulty: "Medium",
        problem: "Radio de giro de una part√≠cula $q, m$ en campo $B$ con velocidad $v$.",
        steps: [
          "$qvB = mv^2/R \\Rightarrow R = \\frac{mv}{qB}$."
        ],
        solution: "$$ R = \\frac{mv}{qB} $$"
      },
      {
        id: "F2-010",
        category: "f2",
        topic: "Inducci√≥n (Varilla)",
        difficulty: "Medium",
        problem: "FEM inducida en una varilla de longitud $L$ que gira en campo $B$.",
        steps: [
          "$d\\varepsilon = v B dr = \\omega r B dr$.",
          "$\\varepsilon = \\int_0^L \\omega B r dr = \\frac{1}{2}B \\omega L^2$."
        ],
        solution: "$$ \\frac{1}{2}B \\omega L^2 $$"
      },
      {
        id: "F2-011",
        category: "f2",
        topic: "Autoinducci√≥n (Solenoide)",
        difficulty: "Medium",
        problem: "Inductancia por unidad de longitud de un solenoide ideal.",
        steps: [
          "$\\Phi_{tot} = (nl) \\mu_0 n I A$.",
          "$L/l = \\mu_0 n^2 A$."
        ],
        solution: "$$ \\mu_0 n^2 A $$"
      },
      {
        id: "F2-012",
        category: "f2",
        topic: "Energ√≠a Magn√©tica",
        difficulty: "Medium",
        problem: "Densidad de energ√≠a magn√©tica.",
        steps: [
          "$u = \\frac{B^2}{2\\mu_0}$."
        ],
        solution: "$$ \\frac{B^2}{2\\mu_0} $$"
      },
      {
        id: "F2-013",
        category: "f2",
        topic: "Ecuaciones Maxwell",
        difficulty: "Hard",
        problem: "Demuestra que $\\vec{E}$ satisface la ecuaci√≥n de onda en el vac√≠o.",
        steps: [
          "$\\nabla \\times (\\nabla \\times \\vec{E}) = -\\nabla^2\\vec{E}$.",
          "$\\nabla \\times (-\\dot{\\vec{B}}) = -\\mu_0 \\epsilon_0 \\ddot{\\vec{E}}$."
        ],
        solution: "$$ \\nabla^2 \\vec{E} - \\frac{1}{c^2}\\ddot{\\vec{E}} = 0 $$"
      },
      {
        id: "F2-014",
        category: "f2",
        topic: "Vector Poynting",
        difficulty: "Medium",
        problem: "Intensidad de una onda EM plana.",
        steps: [
          "$S = EB/\\mu_0$. $I = \\langle S \\rangle = \\frac{E_{max}^2}{2\\mu_0 c}$."
        ],
        solution: "$$ \\frac{E_0^2}{2\\mu_0 c} $$"
      },
      {
        id: "F2-015",
        category: "f2",
        topic: "Efecto Hall",
        difficulty: "Medium",
        problem: "Voltaje Hall en una cinta conductora.",
        steps: [
          "$qE_H = qv_d B$. $V_H = v_d B w$.",
          "$V_H = \\frac{IB}{nqt}$."
        ],
        solution: "$$ \\frac{IB}{nqt} $$"
      },
      {
        id: "F2-016",
        category: "f2",
        topic: "Momento Magn√©tico",
        difficulty: "Medium",
        problem: "Torque sobre una espira rectangular en campo $B$.",
        steps: [
          "$\\vec{\\tau} = \\vec{\\mu} \\times \\vec{B}$."
        ],
        solution: "$$ \\vec{\\mu} \\times \\vec{B} $$"
      },
      {
        id: "F2-017",
        category: "f2",
        topic: "Inducci√≥n Mutua",
        difficulty: "Hard",
        problem: "Inductancia mutua entre solenoide largo y bobina corta.",
        steps: [
          "$\\Phi_2 = N \\mu_0 n I_1 A$.",
          "$M = \\mu_0 n N A$."
        ],
        solution: "$$ \\mu_0 n N A $$"
      },
      {
        id: "F2-018",
        category: "f2",
        topic: "Corriente Desplazamiento",
        difficulty: "Medium",
        problem: "Corriente de desplazamiento en condensador carg√°ndose.",
        steps: [
          "$I_d = \\epsilon_0 \\frac{d\\Phi_E}{dt} = I_{cond}$."
        ],
        solution: "$$ I_d = I_{conduccion} $$"
      },
      {
        id: "F2-019",
        category: "f2",
        topic: "Cu√°ntica (Pozo Infinito)",
        difficulty: "Medium",
        problem: "Energ√≠as permitidas en pozo infinito de ancho $L$.",
        steps: [
          "$kL = n\\pi$. $E = \\frac{\\hbar^2 k^2}{2m}$."
        ],
        solution: "$$ \\frac{n^2 h^2}{8mL^2} $$"
      },
      {
        id: "F2-020",
        category: "f2",
        topic: "Incertidumbre",
        difficulty: "Medium",
        problem: "Incertidumbre m√≠nima en velocidad de un electr√≥n confinado en $\\Delta x$.",
        steps: [
          "$\\Delta v \\ge \\frac{\\hbar}{2m\\Delta x}$."
        ],
        solution: "$$ \\ge \\frac{\\hbar}{2m\\Delta x} $$"
      },
      {
        id: "F2-021",
        category: "f2",
        topic: "Efecto Compton",
        difficulty: "Hard",
        problem: "Cambio de longitud de onda en dispersi√≥n Compton a 90¬∞.",
        steps: [
          "$\\Delta \\lambda = \\frac{h}{mc}(1 - \\cos 90^\\circ) = \\frac{h}{mc}$."
        ],
        solution: "$$ 2.43 \\text{ pm} $$"
      },
      {
        id: "F2-022",
        category: "f2",
        topic: "√Åtomo Bohr",
        difficulty: "Medium",
        problem: "Radio de la primera √≥rbita de Bohr.",
        steps: [
          "$mvr = \\hbar$. $k e^2/r^2 = mv^2/r$.",
          "$r = \\frac{\\hbar^2}{mk e^2}$."
        ],
        solution: "$$ a_0 \\approx 0.53 \\mathring{A} $$"
      },
      {
        id: "F2-023",
        category: "f2",
        topic: "T√∫nel Cu√°ntico",
        difficulty: "Hard",
        problem: "Coeficiente de transmisi√≥n aproximado barrera rectangular.",
        steps: [
          "$T \\approx e^{-2\\gamma L}$."
        ],
        solution: "$$ e^{-2\\gamma L} $$"
      },
      {
        id: "F2-024",
        category: "f2",
        topic: "Gravitaci√≥n (T√∫nel Tierra)",
        difficulty: "Hard",
        problem: "Si cavamos un t√∫nel que atraviesa la Tierra, halla el periodo de oscilaci√≥n.",
        steps: [
          "$F(r) = -\\frac{GMm}{R^3}r$. MAS con $\\omega = \\sqrt{g/R}$.",
          "$T = 2\\pi \\sqrt{R/g}$."
        ],
        solution: "$$ T \\approx 84 \\text{ min} $$"
      },
      {
        id: "F2-025",
        category: "f2",
        topic: "Campo Gravitatorio (Esfera)",
        difficulty: "Medium",
        problem: "Campo gravitatorio en el interior de una corteza esf√©rica hueca.",
        steps: [
          "Gauss: $M_{enc} = 0$.",
          "$g = 0$."
        ],
        solution: "$$ 0 $$"
      }
    ];

    const modal = document.getElementById('modal');
    let currentFilter = 'all';

    function renderGrid(data) {
      const grid = document.getElementById('grid');
      if (!grid) return;

      grid.innerHTML = data.map((ex, index) => `
  <article class="exercise-card" style="animation-delay: ${index * 0.05}s" onclick="openModal('${ex.id}')">
    <div class="card-header">
      <div class="card-badges">
        <span class="badge badge-diff-${ex.difficulty.toLowerCase()}">${ex.difficulty}</span>
        <span class="badge badge-topic">${ex.topic}</span>
      </div>
      <span class="card-id">${ex.id}</span>
    </div>
    <div class="card-body">
      <div class="problem-preview">${ex.problem}</div>
    </div>
    <div class="card-footer">
      <span class="view-sol-btn">Ver Soluci√≥n Completa</span>
    </div>
  </article>
  `).join('');

      if (window.MathJax) {
        MathJax.typesetPromise([grid]).catch(err => console.log('MathJax error:', err));
      }
    }

    function openModal(id) {
      const ex = exercises.find(e => e.id === id);
      if (!ex) return;

      document.getElementById('modal-title').textContent = ex.topic;
      document.getElementById('modal-id').textContent = ex.id;
      document.getElementById('modal-problem').innerHTML = ex.problem;

      const stepsContainer = document.getElementById('modal-steps');
      stepsContainer.innerHTML = '<span class="section-label">Soluci√≥n Paso a Paso</span>';

      ex.steps.forEach((step, i) => {
        stepsContainer.innerHTML += `
  <div class="step-card" style="animation-delay: ${i * 0.1}s">
    <span class="step-number">PASO ${i + 1}</span>
    <div class="step-content">${step}</div>
  </div>
  `;
      });

      stepsContainer.innerHTML += `
  <div class="final-answer">
    <span class="final-label">Resultado Final</span>
    <div class="final-math">${ex.solution}</div>
  </div>
  `;

      modal.classList.add('active');
      if (window.MathJax) {
        MathJax.typesetPromise([modal]).catch(err => console.log('MathJax error:', err));
      }
    }

    function closeModal() {
      modal.classList.remove('active');
    }

    function filterExercises(cat) {
      currentFilter = cat;

      document.querySelectorAll('.nav-item').forEach(btn => btn.classList.remove('active'));
      event.currentTarget.classList.add('active');

      const filtered = cat === 'all' ? exercises : exercises.filter(e => e.category === cat);
      renderGrid(filtered);
    }

    function toggleTheme() {
      const html = document.documentElement;
      const current = html.getAttribute('data-theme');
      const next = current === 'dark' ? 'light' : 'dark';
      html.setAttribute('data-theme', next);

      const icon = document.getElementById('theme-icon');
      if (icon) icon.textContent = next === 'dark' ? 'üåô' : '‚òÄÔ∏è';
    }

    modal.addEventListener('click', (e) => {
      if (e.target === modal) closeModal();
    });

    // Ensure DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
      renderGrid(exercises);
    });
  </script>
</body>

</html>
