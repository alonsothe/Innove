<!DOCTYPE html>
<html lang="es" data-theme="light">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Banco de M√°quinas de Fluidos UPC - Nivel Avanzado</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@500;700&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet">

  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$']],
        processEscapes: true,
        tags: 'ams'
      },
      options: {
        renderActions: { addMenu: [] }
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    /* ========================================
       ESTILOS (Mismos que el anterior)
       ======================================== */
    :root {
      --sidebar-width: 280px;
      --header-height: 70px;
      --card-radius: 16px;
      --modal-radius: 24px;
      --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
      --font-display: 'Space Grotesk', sans-serif;
      --font-mono: 'JetBrains Mono', monospace;
      --ease-out: cubic-bezier(0.215, 0.61, 0.355, 1);
      --ease-in-out: cubic-bezier(0.645, 0.045, 0.355, 1);
      --duration-fast: 0.2s;
      --duration-normal: 0.4s;
      --duration-slow: 0.6s;
    }

    [data-theme="dark"] {
      --bg-app: #050505;
      --bg-sidebar: #0a0a0a;
      --bg-card: #111111;
      --bg-card-hover: #161616;
      --bg-modal: #0f0f0f;
      --bg-input: #1a1a1a;
      --text-primary: #ffffff;
      --text-secondary: #a1a1aa;
      --text-tertiary: #52525b;
      --border-light: rgba(255, 255, 255, 0.06);
      --border-hover: rgba(255, 255, 255, 0.12);
      --accent-primary: #2563eb; /* Azul UPC */
      --accent-secondary: #ef4444; /* Rojo UPC */
      --accent-success: #10b981;
      --accent-warning: #f59e0b;
      --accent-danger: #dc2626;
      --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.3);
      --shadow-md: 0 8px 16px rgba(0, 0, 0, 0.4);
      --shadow-lg: 0 24px 48px rgba(0, 0, 0, 0.6);
      --glow-primary: 0 0 20px rgba(37, 99, 235, 0.15);
    }

    [data-theme="light"] {
      --bg-app: #f8fafc;
      --bg-sidebar: #ffffff;
      --bg-card: #ffffff;
      --bg-card-hover: #f1f5f9;
      --bg-modal: #ffffff;
      --bg-input: #f1f5f9;
      --text-primary: #0f172a;
      --text-secondary: #64748b;
      --text-tertiary: #94a3b8;
      --border-light: rgba(0, 0, 0, 0.06);
      --border-hover: rgba(0, 0, 0, 0.1);
      --accent-primary: #dc2626; /* Rojo UPC */
      --accent-secondary: #1d4ed8; /* Azul */
      --accent-success: #059669;
      --accent-warning: #d97706;
      --accent-danger: #dc2626;
      --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.05);
      --shadow-md: 0 8px 16px rgba(0, 0, 0, 0.08);
      --shadow-lg: 0 24px 48px rgba(0, 0, 0, 0.12);
      --glow-primary: 0 0 20px rgba(220, 38, 38, 0.1);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
    body { font-family: var(--font-sans); background-color: var(--bg-app); color: var(--text-primary); height: 100vh; overflow: hidden; display: flex; transition: background-color var(--duration-normal) var(--ease-out); }
    a { text-decoration: none; color: inherit; }
    button { border: none; background: none; cursor: pointer; font-family: inherit; }
    ul { list-style: none; }
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: var(--border-hover); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--text-tertiary); }
    .h1 { font-family: var(--font-display); font-size: 2.5rem; font-weight: 700; letter-spacing: -0.02em; line-height: 1.1; }
    .h2 { font-family: var(--font-display); font-size: 1.75rem; font-weight: 700; letter-spacing: -0.01em; }
    .h3 { font-family: var(--font-display); font-size: 1.25rem; font-weight: 600; }
    .text-sm { font-size: 0.875rem; }
    .text-xs { font-size: 0.75rem; }
    .font-mono { font-family: var(--font-mono); }
    .text-muted { color: var(--text-secondary); }

    .sidebar { width: var(--sidebar-width); height: 100%; background: var(--bg-sidebar); border-right: 1px solid var(--border-light); display: flex; flex-direction: column; padding: 24px; z-index: 10; transition: transform var(--duration-normal) var(--ease-out); }
    .brand { display: flex; align-items: center; gap: 12px; margin-bottom: 40px; padding-left: 12px; }
    .brand-logo { width: 36px; height: 36px; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); border-radius: 10px; display: grid; place-items: center; font-weight: 700; color: white; font-size: 1.2rem; box-shadow: var(--glow-primary); }
    .brand-text { font-family: var(--font-display); font-size: 1.25rem; font-weight: 700; letter-spacing: -0.02em; }
    .nav-menu { display: flex; flex-direction: column; gap: 8px; flex-grow: 1; }
    .nav-item { display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-radius: 12px; color: var(--text-secondary); font-weight: 500; transition: all var(--duration-fast); }
    .nav-item:hover { background: var(--bg-input); color: var(--text-primary); }
    .nav-item.active { background: rgba(220, 38, 38, 0.1); color: var(--accent-primary); }
    .nav-icon { width: 20px; height: 20px; opacity: 0.7; }
    .sidebar-footer { margin-top: auto; padding-top: 24px; border-top: 1px solid var(--border-light); }
    .stats-card { background: var(--bg-input); padding: 16px; border-radius: 12px; margin-bottom: 16px; }
    .stat-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.85rem; }
    .progress-bar { width: 100%; height: 4px; background: var(--border-hover); border-radius: 2px; overflow: hidden; }
    .progress-fill { height: 100%; background: var(--accent-success); width: 0%; transition: width 1s var(--ease-out); }

    .main-content { flex-grow: 1; height: 100%; overflow-y: auto; padding: 40px 60px; position: relative; }
    .header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 40px; animation: slideDown 0.6s var(--ease-out); }
    .header-content h1 { margin-bottom: 8px; }
    .header-content p { max-width: 600px; line-height: 1.6; }
    .header-actions { display: flex; gap: 16px; }
    .theme-btn { width: 44px; height: 44px; border-radius: 12px; border: 1px solid var(--border-light); display: grid; place-items: center; color: var(--text-secondary); transition: all var(--duration-fast); }
    .theme-btn:hover { background: var(--bg-card-hover); color: var(--text-primary); border-color: var(--border-hover); }
    .filter-bar { display: flex; gap: 12px; margin-bottom: 32px; overflow-x: auto; padding-bottom: 4px; animation: fadeIn 0.8s var(--ease-out); }
    .filter-chip { padding: 8px 16px; border-radius: 100px; border: 1px solid var(--border-light); background: var(--bg-card); color: var(--text-secondary); font-size: 0.875rem; font-weight: 500; white-space: nowrap; transition: all var(--duration-fast); }
    .filter-chip:hover { border-color: var(--accent-primary); color: var(--text-primary); }
    .filter-chip.active { background: var(--accent-primary); border-color: var(--accent-primary); color: white; box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3); }

    .exercise-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 24px; padding-bottom: 60px; }
    .exercise-card { background: var(--bg-card); border: 1px solid var(--border-light); border-radius: var(--card-radius); padding: 24px; display: flex; flex-direction: column; transition: all var(--duration-fast); cursor: pointer; position: relative; overflow: hidden; animation: fadeInUp 0.6s var(--ease-out) backwards; }
    .exercise-card:hover { transform: translateY(-4px); border-color: var(--border-hover); box-shadow: var(--shadow-md); background: var(--bg-card-hover); }
    .card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 16px; }
    .card-badges { display: flex; gap: 8px; flex-wrap: wrap; }
    .badge { padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
    .badge-diff-easy { background: rgba(16, 185, 129, 0.1); color: var(--accent-success); }
    .badge-diff-medium { background: rgba(245, 158, 11, 0.1); color: var(--accent-warning); }
    .badge-diff-hard { background: rgba(239, 68, 68, 0.1); color: var(--accent-danger); }
    .badge-topic { background: var(--bg-input); color: var(--text-secondary); border: 1px solid var(--border-light); }
    .card-id { font-family: var(--font-mono); font-size: 0.75rem; color: var(--text-tertiary); }
    .card-body { flex-grow: 1; margin-bottom: 20px; }
    .problem-preview { font-size: 1rem; line-height: 1.6; color: var(--text-primary); display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
    .card-footer { display: flex; justify-content: space-between; align-items: center; padding-top: 16px; border-top: 1px solid var(--border-light); }
    .view-sol-btn { font-size: 0.875rem; font-weight: 600; color: var(--accent-primary); display: flex; align-items: center; gap: 6px; }
    .view-sol-btn::after { content: '‚Üí'; transition: transform 0.2s; }
    .exercise-card:hover .view-sol-btn::after { transform: translateX(4px); }

    .modal-backdrop { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(8px); z-index: 1000; display: none; opacity: 0; transition: opacity var(--duration-normal); }
    .modal-backdrop.active { display: flex; justify-content: center; align-items: center; opacity: 1; }
    .modal-content { width: 90%; max-width: 1000px; height: 90%; background: var(--bg-modal); border-radius: var(--modal-radius); border: 1px solid var(--border-light); box-shadow: var(--shadow-lg); display: flex; flex-direction: column; transform: scale(0.95) translateY(20px); transition: transform var(--duration-normal) var(--ease-out); overflow: hidden; }
    .modal-backdrop.active .modal-content { transform: scale(1) translateY(0); }
    .modal-header { padding: 24px 32px; border-bottom: 1px solid var(--border-light); display: flex; justify-content: space-between; align-items: center; background: var(--bg-card); }
    .modal-title-group h2 { margin-bottom: 4px; }
    .modal-subtitle { font-family: var(--font-mono); color: var(--text-tertiary); font-size: 0.9rem; }
    .close-modal-btn { width: 40px; height: 40px; border-radius: 50%; background: var(--bg-input); color: var(--text-secondary); display: grid; place-items: center; font-size: 1.2rem; transition: all 0.2s; }
    .close-modal-btn:hover { background: var(--accent-danger); color: white; transform: rotate(90deg); }
    .modal-body { flex-grow: 1; overflow-y: auto; padding: 40px; display: grid; grid-template-columns: 1fr 1fr; gap: 40px; }
    .problem-section { padding-right: 40px; border-right: 1px solid var(--border-light); }
    .solution-section { padding-left: 10px; }
    .section-label { font-family: var(--font-mono); font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--accent-primary); margin-bottom: 16px; display: block; }
    .problem-text { font-size: 1.25rem; line-height: 1.7; margin-bottom: 32px; }
    .step-card { background: var(--bg-input); border-radius: 12px; padding: 20px; margin-bottom: 20px; border-left: 3px solid var(--accent-secondary); animation: slideInRight 0.5s var(--ease-out) backwards; }
    .step-number { font-family: var(--font-mono); font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 8px; display: block; }
    .final-answer { margin-top: 40px; padding: 24px; background: rgba(16, 185, 129, 0.1); border: 1px solid var(--accent-success); border-radius: 12px; text-align: center; }
    .final-label { color: var(--accent-success); font-weight: 700; text-transform: uppercase; font-size: 0.8rem; margin-bottom: 12px; display: block; }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes slideDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes slideInRight { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }

    @media (max-width: 1024px) {
      .sidebar { width: 80px; padding: 16px; }
      .brand-text, .nav-text, .stats-card { display: none; }
      .brand { justify-content: center; padding: 0; }
      .nav-item { justify-content: center; padding: 16px; }
      .main-content { padding: 20px; }
      .modal-body { grid-template-columns: 1fr; }
      .problem-section { border-right: none; border-bottom: 1px solid var(--border-light); padding-bottom: 30px; margin-bottom: 30px; padding-right: 0; }
      .solution-section { padding-left: 0; }
    }
  </style>
</head>

<body>

  <aside class="sidebar">
    <div class="brand">
      <div class="brand-logo">Œ¶</div>
      <span class="brand-text">UPC Ingenier√≠a</span>
    </div>

    <nav class="nav-menu">
      <button class="nav-item active" onclick="filterExercises('all')">
        <span class="nav-icon">‚öôÔ∏è</span>
        <span class="nav-text">Banco de Fluidos</span>
      </button>
      <button class="nav-item" onclick="filterExercises('integral')">
        <span class="nav-icon">‚à´</span>
        <span class="nav-text">Integral/Diferencial</span>
      </button>
      <button class="nav-item" onclick="filterExercises('turbomaquinas')">
        <span class="nav-icon">üåÄ</span>
        <span class="nav-text">Turbom√°quinas</span>
      </button>
    </nav>

    <div class="sidebar-footer">
      <div class="stats-card">
        <div class="stat-row">
          <span>Nivel: Ingenier√≠a</span>
          <span>UPC</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" style="width: 100%"></div>
        </div>
      </div>
    </div>
  </aside>

  <main class="main-content">
    <header class="header">
      <div class="header-content">
        <h1 class="h1">Mec√°nica de Fluidos Avanzada</h1>
        <p class="text-muted">Ejercicios tipo Parcial y Final para Ingenier√≠a. Incluye An√°lisis Diferencial, Navier-Stokes, Capa L√≠mite y Turbom√°quinas.</p>
      </div>
      <div class="header-actions">
        <button class="theme-btn" onclick="toggleTheme()" aria-label="Toggle Theme">
          <span id="theme-icon">‚òÄÔ∏è</span>
        </button>
      </div>
    </header>

    <div class="filter-bar" id="topic-filters">
      </div>

    <div class="exercise-grid" id="grid">
      <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: var(--text-secondary);">
        Cargando ejercicios de nivel avanzado...
      </div>
    </div>
  </main>

  <div class="modal-backdrop" id="modal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title-group">
          <h2 class="h2" id="modal-title">T√≠tulo del Problema</h2>
          <span class="modal-subtitle" id="modal-id">ID: C1-001</span>
        </div>
        <button class="close-modal-btn" onclick="closeModal()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="problem-section">
          <span class="section-label">Enunciado del Problema (Nivel Parcial)</span>
          <div class="problem-text" id="modal-problem">
            </div>
          <div class="tags" id="modal-tags">
            </div>
        </div>
        <div class="solution-section" id="modal-steps">
          <span class="section-label">Desarrollo Matem√°tico</span>
          </div>
      </div>
    </div>
  </div>

  <script>
    const exercises = [
      // ============================================================
      // TEOREMA DE TRANSPORTE DE REYNOLDS & CONSERVACI√ìN DE MOMENTO
      // ============================================================
      {
        id: "FLU-ADV-001",
        category: "integral",
        topic: "RTT - Perfil no Uniforme",
        difficulty: "Hard",
        problem: "Un codo reductor de $90^\\circ$ se encuentra en un plano horizontal. A la entrada (secci√≥n 1, radio $R_1$) el flujo es uniforme con velocidad $U_1$. En la salida (secci√≥n 2, radio $R_2$), el perfil de velocidad es parab√≥lico: $u(r) = U_{max} (1 - (r/R_2)^2)$. Calcule la fuerza de anclaje requerida en el eje X asumiendo fluido incompresible y presi√≥n manom√©trica $P_1$ en la entrada y descarga libre $P_2=0$.",
        steps: [
          "",
          "**Paso 1: Continuidad (Integral).** Hallar $U_{max}$ en funci√≥n de $U_1$. <br> $Q = \\int_0^{R_2} u(r) 2\\pi r dr = U_1 \\pi R_1^2$. <br> Integrando: $U_{max} = 2 U_1 (R_1/R_2)^2$.",
          "**Paso 2: Momento Lineal en X.** <br> $\\sum F_x = \\int_{SC} u (\\rho \\vec{V} \\cdot d\\vec{A})$. <br> $P_1 A_1 - F_{Rx} = \\dot{M}_{sal,x} - \\dot{M}_{ent,x}$.",
          "**Paso 3: Flujo de Momento Salida.** Como la salida es en Y, la componente X es 0. $\\dot{M}_{sal,x} = 0$.",
          "**Paso 4: Flujo de Momento Entrada.** <br> $\\dot{M}_{ent,x} = \\int_{A_1} U_1 (-\\rho U_1) dA = -\\rho U_1^2 A_1$.",
          "**Paso 5: Despeje.** <br> $F_{Rx} = P_1 A_1 + \\rho U_1^2 A_1$."
        ],
        solution: "$$ F_{Rx} = (P_1 + \\rho U_1^2)\\pi R_1^2 $$"
      },
      {
        id: "FLU-ADV-002",
        category: "integral",
        topic: "Hidrost√°tica Avanzada (Integraci√≥n)",
        difficulty: "Hard",
        problem: "Una compuerta tiene la forma de la curva $y = H(x/b)^3$ con ancho $w$ constante perpendicular al papel. El fluido tiene densidad $\\rho$ y llega hasta la altura $H$. Calcule la fuerza horizontal y vertical mediante integraci√≥n directa.",
        steps: [
          "",
          "**Fuerza Horizontal:** Proyecci√≥n vertical. <br> $dF_H = P dA_v = (\\rho g (H-y)) (w dy)$. <br> $F_H = \\rho g w \\int_0^H (H-y) dy = \\frac{1}{2}\\rho g w H^2$.",
          "**Fuerza Vertical:** Peso del volumen sobre la curva. <br> $dF_V = P dA_h = (\\rho g (H-y)) (w dx)$.",
          "Sustituir $y$: $F_V = \\rho g w \\int_0^b (H - H(x/b)^3) dx$.",
          "Integrando: $F_V = \\rho g w H [x - \\frac{x^4}{4b^3}]_0^b = \\rho g w H (b - b/4) = \\frac{3}{4}\\rho g w H b$."
        ],
        solution: "$$ F_H = \\frac{1}{2}\\gamma w H^2, \\quad F_V = \frac{3}{4}\\gamma w H b $$"
      },
      
      // ============================================================
      // AN√ÅLISIS DIFERENCIAL (NAVIER-STOKES)
      // ============================================================
      {
        id: "FLU-ADV-003",
        category: "integral",
        topic: "Navier-Stokes (Couette Cilindrico)",
        difficulty: "Hard",
        problem: "Un fluido viscoso ($\\mu$) est√° contenido entre dos cilindros conc√©ntricos infinitos de radios $R_1$ y $R_2$ ($R_2 > R_1$). El cilindro interior gira a $\\omega_1$ y el exterior est√° fijo. Hallar la distribuci√≥n de velocidad $v_\\theta(r)$ resolviendo N-S en coordenadas cil√≠ndricas.",
        steps: [
          "**Simplificaci√≥n N-S:** Flujo estacionario, laminar, $v_r=v_z=0$, simetr√≠a axial ($\\partial/\\partial \\theta = 0$).",
          "Ecuaci√≥n $\\theta$: $\\frac{d}{dr}\\left( \\frac{1}{r} \\frac{d}{dr}(r v_\\theta) \\right) = 0$.",
          "**Integraci√≥n 1:** $\\frac{1}{r} \\frac{d}{dr}(r v_\\theta) = C_1 \\implies \\frac{d}{dr}(r v_\\theta) = C_1 r$.",
          "**Integraci√≥n 2:** $r v_\\theta = C_1 \\frac{r^2}{2} + C_2 \\implies v_theta(r) = A r + \\frac{B}{r}$.",
          "**Condiciones de Frontera:** <br> 1) $r=R_1, v_\\theta = \\omega_1 R_1$. <br> 2) $r=R_2, v_\\theta = 0$.",
          "Resolver sistema para A y B."
        ],
        solution: "$$ v_\\theta(r) = \\frac{\\omega_1 R_1^2}{R_2^2 - R_1^2} \\left( \\frac{R_2^2}{r} - r \\right) $$"
      },
      {
        id: "FLU-ADV-004",
        category: "integral",
        topic: "Capa L√≠mite (Soluci√≥n Blasius)",
        difficulty: "Hard",
        problem: "Para la soluci√≥n de Blasius sobre placa plana, demuestre que la velocidad vertical $v$ dentro de la capa l√≠mite no es cero y encuentre su expresi√≥n en funci√≥n de la funci√≥n de corriente $\\psi(x,y) = \\sqrt{\\nu U x} f(\\eta)$.",
        steps: [
          "Definici√≥n: $u = \\frac{\\partial \\psi}{\\partial y}$, $v = -\\frac{\\partial \\psi}{\\partial x}$.",
          "Derivada parcial respecto a $x$: <br> $\\psi = \\sqrt{\\nu U} x^{1/2} f(\\eta)$, donde $\\eta = y \\sqrt{U/\\nu x}$.",
          "Regla de la cadena para $\\partial f/\\partial x = f' \\cdot \\frac{\\partial \\eta}{\\partial x}$. <br> $\\frac{\\partial \\eta}{\\partial x} = -\\frac{\\eta}{2x}$.",
          "Sustituir y operar algebraicamente."
        ],
        solution: "$$ v = \\frac{1}{2} \\sqrt{\\frac{\\nu U}{x}} (\\eta f' - f) $$"
      },

      // ============================================================
      // FLUJO POTENCIAL & COMPLEJO
      // ============================================================
      {
        id: "FLU-ADV-005",
        category: "integral",
        topic: "Flujo Potencial (Cilindro Rotatorio)",
        difficulty: "Hard",
        problem: "Considere la superposici√≥n de flujo uniforme $U$, un doblete y un v√≥rtice de circulaci√≥n $\\Gamma$ (Efecto Magnus). Encuentre la localizaci√≥n de los puntos de estancamiento sobre la superficie del cilindro ($r=R$).",
        steps: [
          "",
          "Potencial complejo: $W(z) = U(z + R^2/z) + i\\Gamma/2\\pi \\ln z$.",
          "Velocidad tangencial en superficie ($r=R$): <br> $v_\\theta = -2U \\sin\\theta + \\frac{\\Gamma}{2\\pi R}$.",
          "Punto estancamiento: $v_\\theta = 0$.",
          "$\\sin\\theta_{stag} = \\frac{\\Gamma}{4\\pi U R}$."
        ],
        solution: "$$ \\theta = \\arcsin\\left(\\frac{\\Gamma}{4\\pi U R}\\right) $$"
      },

      // ============================================================
      // TURBOM√ÅQUINAS & SISTEMAS
      // ============================================================
      {
        id: "FLU-ADV-006",
        category: "turbomaquinas",
        topic: "Tri√°ngulos de Velocidad (Bomba)",
        difficulty: "Hard",
        problem: "Una bomba centr√≠fuga gira a $N=1450$ rpm. Radio entrada $r_1=10cm$, radio salida $r_2=20cm$. Ancho √°labe constante $b=4cm$. Caudal $Q=0.1 m^3/s$. Entrada radial ($V_{u1}=0$). √Ångulo de salida del √°labe $\\beta_2 = 30^\\circ$. Calcule la altura te√≥rica de Euler.",
        steps: [
          "",
          "**Paso 1: Velocidades Perif√©ricas ($u$).** <br> $u_2 = \\omega r_2 = \\frac{2\\pi N}{60} r_2$.",
          "**Paso 2: Velocidad de Flujo ($V_m$).** <br> $V_{m2} = Q / (2\\pi r_2 b)$.",
          "**Paso 3: Tri√°ngulo de Salida.** <br> $\\tan \\beta_2 = V_{m2} / (u_2 - V_{u2})$. Despejar $V_{u2}$.",
          "**Paso 4: Ecuaci√≥n Euler.** <br> $H_{th} = \\frac{u_2 V_{u2} - u_1 V_{u1}}{g}$. (Dado $V_{u1}=0$)."
        ],
        solution: "$$ H_{th} = u_2 (u_2 - V_{m2} \\cot \\beta_2) / g $$"
      },
      {
        id: "FLU-ADV-007",
        category: "turbomaquinas",
        topic: "Golpe de Ariete (Allievi)",
        difficulty: "Medium",
        problem: "Una tuber√≠a de acero ($E=2\\cdot 10^{11} Pa$) de $D=600mm$ y espesor $e=10mm$ transporta agua ($K=2.2\\cdot 10^9 Pa$) a $2 m/s$. Se cierra una v√°lvula en 0.5s. Longitud $L=2000m$. Determine la sobrepresi√≥n m√°xima.",
        steps: [
          "**Celeridad de onda (a):** $a = \\sqrt{\\frac{K/\\rho}{1 + (K/E)(D/e)}}$.",
          "**Tiempo cr√≠tico:** $T_c = 2L/a$.",
          "Comparar $t_{cierre}$ con $T_c$.",
          "Si $t_{cierre} < T_c$ (Cierre r√°pido): $\\Delta P = \\rho a V$ (Joukowsky)."
        ],
        solution: "$$ \\Delta H = \\frac{aV}{g} $$"
      },
      {
        id: "FLU-ADV-008",
        category: "integral",
        topic: "Vaciado de Tanque (Geometr√≠a Variable)",
        difficulty: "Hard",
        problem: "Un tanque c√≥nico (v√©rtice abajo) de altura $H$ y radio superior $R$ se vac√≠a por un orificio de √°rea $a_0$ en el fondo. Encuentre el tiempo de vaciado total.",
        steps: [
          "Relaci√≥n geom√©trica radio-altura: $r(z) = (R/H)z$.",
          "√Årea superficial: $A(z) = \\pi (R/H)^2 z^2$.",
          "Ec. Continuidad no permanente: $-A(z) dz = a_0 \\sqrt{2gz} dt$.",
          "Integral: $\\int_H^0 -\\pi (R/H)^2 z^{3/2} dz = \\int_0^t a_0 \\sqrt{2g} dt$."
        ],
        solution: "$$ t = \\frac{\\pi R^2}{a_0 \\sqrt{2g}} \\frac{2}{5} H^{1/2} $$"
      },
      {
        id: "FLU-ADV-009",
        category: "integral",
        topic: "Fuerzas sobre cuerpos sumergidos (Empuje)",
        difficulty: "Hard",
        problem: "Un bloque de densidad $\\rho_b$ flota en la interfaz entre dos fluidos inmiscibles de densidades $\\rho_1$ y $\\rho_2$ ($\\rho_1 < \\rho_b < \\rho_2$). Determine la fracci√≥n del volumen sumergido en el fluido m√°s denso.",
        steps: [
          "Equilibrio: $W = E_1 + E_2$.",
          "$\\rho_b g V_{tot} = \\rho_1 g V_1 + \\rho_2 g V_2$.",
          "$V_{tot} = V_1 + V_2$. Sustituir $V_1 = V_{tot} - V_2$.",
          "$\\rho_b V_{tot} = \\rho_1 (V_{tot} - V_2) + \\rho_2 V_2$."
        ],
        solution: "$$ \\frac{V_2}{V_{tot}} = \\frac{\\rho_b - \\rho_1}{\\rho_2 - \\rho_1} $$"
      },
      {
        id: "FLU-ADV-010",
        category: "turbomaquinas",
        topic: "Bombas en Serie/Paralelo",
        difficulty: "Medium",
        problem: "Dos bombas id√©nticas con curva $H = 50 - 5000Q^2$ se instalan en paralelo. La curva del sistema es $H_{sis} = 20 + 15000Q_{tot}^2$. Halle el caudal total entregado.",
        steps: [
          "Bomba equivalente paralelo: Para un mismo H, $Q_{eq} = 2Q_{ind}$.",
          "Invertir curva bomba: $Q_{ind} = \\sqrt{(50-H)/5000}$.",
          "$Q_{tot} = 2\\sqrt{(50-H)/5000} \\implies Q_{tot}^2 = 4(50-H)/5000$.",
          "Curva Equiv: $H = 50 - 1250 Q_{tot}^2$.",
          "Igualar con sistema: $50 - 1250Q^2 = 20 + 15000Q^2$."
        ],
        solution: "$$ Q_{tot} \\approx 43 \\text{ L/s} $$"
      }
    ];

    const modal = document.getElementById('modal');
    let currentFilter = 'all';

    function renderGrid(data) {
      const grid = document.getElementById('grid');
      if (!grid) return;

      grid.innerHTML = data.map((ex, index) => `
<article class="exercise-card" style="animation-delay: ${index * 0.05}s" onclick="openModal('${ex.id}')">
  <div class="card-header">
    <div class="card-badges">
      <span class="badge badge-diff-${ex.difficulty.toLowerCase()}">${ex.difficulty}</span>
      <span class="badge badge-topic">${ex.topic}</span>
    </div>
    <span class="card-id">${ex.id}</span>
  </div>
  <div class="card-body">
    <div class="problem-preview">${ex.problem}</div>
  </div>
  <div class="card-footer">
    <span class="view-sol-btn">Ver Desarrollo Completo</span>
  </div>
</article>
`).join('');

      if (window.MathJax) {
        MathJax.typesetPromise([grid]).catch(err => console.log('MathJax error:', err));
      }
    }

    function openModal(id) {
      const ex = exercises.find(e => e.id === id);
      if (!ex) return;

      document.getElementById('modal-title').textContent = ex.topic;
      document.getElementById('modal-id').textContent = ex.id;
      document.getElementById('modal-problem').innerHTML = ex.problem;

      const stepsContainer = document.getElementById('modal-steps');
      stepsContainer.innerHTML = '<span class="section-label">Desarrollo Matem√°tico</span>';

      ex.steps.forEach((step, i) => {
        stepsContainer.innerHTML += `
<div class="step-card" style="animation-delay: ${i * 0.1}s">
  <span class="step-number">PASO ${i + 1}</span>
  <div class="step-content">${step}</div>
</div>
`;
      });

      stepsContainer.innerHTML += `
<div class="final-answer">
  <span class="final-label">Resultado Final</span>
  <div class="final-math">${ex.solution}</div>
</div>
`;

      modal.classList.add('active');
      if (window.MathJax) {
        MathJax.typesetPromise([modal]).catch(err => console.log('MathJax error:', err));
      }
    }

    function closeModal() {
      modal.classList.remove('active');
    }

    function filterExercises(cat) {
      currentFilter = cat;

      document.querySelectorAll('.nav-item').forEach(btn => btn.classList.remove('active'));
      event.currentTarget.classList.add('active');

      const filtered = cat === 'all' ? exercises : exercises.filter(e => e.category === cat);
      renderGrid(filtered);
    }

    function toggleTheme() {
      const html = document.documentElement;
      const current = html.getAttribute('data-theme');
      const next = current === 'dark' ? 'light' : 'dark';
      html.setAttribute('data-theme', next);

      const icon = document.getElementById('theme-icon');
      if (icon) icon.textContent = next === 'dark' ? 'üåô' : '‚òÄÔ∏è';
    }

    modal.addEventListener('click', (e) => {
      if (e.target === modal) closeModal();
    });

    // Ensure DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
      renderGrid(exercises);
    });
  </script>
</body>

</html>
