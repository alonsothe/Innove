<!DOCTYPE html>
<html lang="es" data-theme="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Innove | Circuit Analysis Suite</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@500;700&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet">

  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$']],
        processEscapes: true,
        tags: 'ams'
      },
      options: {
        renderActions: { addMenu: [] }
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    /* ========================================
        1. VARIABLES & THEME CONFIGURATION
        ========================================
        */
    :root {
      /* Dimensions */
      --sidebar-width: 280px;
      --header-height: 70px;
      --card-radius: 16px;
      --modal-radius: 24px;

      /* Typography */
      --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
      --font-display: 'Space Grotesk', sans-serif;
      --font-mono: 'JetBrains Mono', monospace;

      /* Animations */
      --ease-out: cubic-bezier(0.215, 0.61, 0.355, 1);
      --duration-normal: 0.4s;
    }

    [data-theme="dark"] {
      --bg-app: #050505;
      --bg-sidebar: #0a0a0a;
      --bg-card: #111111;
      --bg-card-hover: #161616;
      --bg-modal: #0f0f0f;
      --bg-input: #1a1a1a;
      --text-primary: #ffffff;
      --text-secondary: #a1a1aa;
      --text-tertiary: #52525b;
      --border-light: rgba(255, 255, 255, 0.06);
      --border-hover: rgba(255, 255, 255, 0.12);
      --accent-primary: #3b82f6; /* Electric Blue */
      --accent-secondary: #8b5cf6;
      --accent-success: #10b981;
      --accent-warning: #f59e0b;
      --accent-danger: #ef4444;
      --shadow-lg: 0 24px 48px rgba(0, 0, 0, 0.6);
      --glow-primary: 0 0 20px rgba(59, 130, 246, 0.15);
    }

    [data-theme="light"] {
      --bg-app: #f8fafc;
      --bg-sidebar: #ffffff;
      --bg-card: #ffffff;
      --bg-card-hover: #f1f5f9;
      --bg-modal: #ffffff;
      --bg-input: #f1f5f9;
      --text-primary: #0f172a;
      --text-secondary: #64748b;
      --text-tertiary: #94a3b8;
      --border-light: rgba(0, 0, 0, 0.06);
      --border-hover: rgba(0, 0, 0, 0.1);
      --accent-primary: #2563eb;
      --accent-secondary: #7c3aed;
      --accent-success: #059669;
      --accent-warning: #d97706;
      --accent-danger: #dc2626;
      --shadow-lg: 0 24px 48px rgba(0, 0, 0, 0.12);
      --glow-primary: 0 0 20px rgba(37, 99, 235, 0.1);
    }

    /* ========================================
        2. RESET & UTILITIES
        ========================================
        */
    * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
    body { font-family: var(--font-sans); background-color: var(--bg-app); color: var(--text-primary); height: 100vh; overflow: hidden; display: flex; transition: background-color var(--duration-normal) var(--ease-out); }
    button { border: none; background: none; cursor: pointer; font-family: inherit; }
    
    /* Typography */
    .h1 { font-family: var(--font-display); font-size: 2.5rem; font-weight: 700; letter-spacing: -0.02em; line-height: 1.1; }
    .h2 { font-family: var(--font-display); font-size: 1.75rem; font-weight: 700; letter-spacing: -0.01em; }
    .text-muted { color: var(--text-secondary); }

    /* ========================================
        3. LAYOUT
        ========================================
        */
    .sidebar { width: var(--sidebar-width); height: 100%; background: var(--bg-sidebar); border-right: 1px solid var(--border-light); display: flex; flex-direction: column; padding: 24px; z-index: 10; }
    .brand { display: flex; align-items: center; gap: 12px; margin-bottom: 40px; padding-left: 12px; }
    .brand-logo { width: 36px; height: 36px; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); border-radius: 10px; display: grid; place-items: center; font-weight: 700; color: white; font-size: 1.2rem; box-shadow: var(--glow-primary); }
    .brand-text { font-family: var(--font-display); font-size: 1.25rem; font-weight: 700; }
    
    .nav-menu { display: flex; flex-direction: column; gap: 8px; flex-grow: 1; }
    .nav-item { display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-radius: 12px; color: var(--text-secondary); font-weight: 500; transition: all 0.2s; }
    .nav-item:hover { background: var(--bg-input); color: var(--text-primary); }
    .nav-item.active { background: rgba(59, 130, 246, 0.1); color: var(--accent-primary); }

    .main-content { flex-grow: 1; height: 100%; overflow-y: auto; padding: 40px 60px; position: relative; }
    .header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 40px; }
    
    .theme-btn { width: 44px; height: 44px; border-radius: 12px; border: 1px solid var(--border-light); display: grid; place-items: center; color: var(--text-secondary); }
    .theme-btn:hover { background: var(--bg-card-hover); color: var(--text-primary); border-color: var(--border-hover); }

    /* Grid & Cards */
    .exercise-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 24px; padding-bottom: 60px; }
    .exercise-card { background: var(--bg-card); border: 1px solid var(--border-light); border-radius: var(--card-radius); padding: 24px; display: flex; flex-direction: column; transition: all 0.2s; cursor: pointer; animation: fadeInUp 0.6s backwards; }
    .exercise-card:hover { transform: translateY(-4px); border-color: var(--border-hover); background: var(--bg-card-hover); }
    
    .card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 16px; }
    .card-badges { display: flex; gap: 8px; flex-wrap: wrap; }
    .badge { padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
    
    .badge-diff-hard { background: rgba(239, 68, 68, 0.1); color: var(--accent-danger); }
    .badge-diff-extreme { background: rgba(139, 92, 246, 0.1); color: var(--accent-secondary); border: 1px solid rgba(139, 92, 246, 0.2); }
    .badge-topic { background: var(--bg-input); color: var(--text-secondary); border: 1px solid var(--border-light); }
    
    .problem-preview { font-size: 1rem; line-height: 1.6; color: var(--text-primary); display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; margin-bottom: 20px; }
    .card-footer { border-top: 1px solid var(--border-light); padding-top: 16px; color: var(--accent-primary); font-weight: 600; font-size: 0.875rem; }

    /* Modal */
    .modal-backdrop { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(8px); z-index: 1000; display: none; opacity: 0; transition: opacity 0.3s; }
    .modal-backdrop.active { display: flex; justify-content: center; align-items: center; opacity: 1; }
    .modal-content { width: 90%; max-width: 1000px; height: 90%; background: var(--bg-modal); border-radius: var(--modal-radius); border: 1px solid var(--border-light); display: flex; flex-direction: column; overflow: hidden; transform: scale(0.95); transition: transform 0.3s; }
    .modal-backdrop.active .modal-content { transform: scale(1); }
    
    .modal-header { padding: 24px 32px; border-bottom: 1px solid var(--border-light); display: flex; justify-content: space-between; align-items: center; background: var(--bg-card); }
    .close-modal-btn { width: 40px; height: 40px; border-radius: 50%; background: var(--bg-input); display: grid; place-items: center; font-size: 1.2rem; color: var(--text-secondary); }
    .close-modal-btn:hover { background: var(--accent-danger); color: white; }

    .modal-body { flex-grow: 1; overflow-y: auto; padding: 40px; display: grid; grid-template-columns: 1fr 1fr; gap: 40px; }
    .problem-section { border-right: 1px solid var(--border-light); padding-right: 40px; }
    .solution-section { padding-left: 10px; }
    
    .step-card { background: var(--bg-input); border-radius: 12px; padding: 20px; margin-bottom: 20px; border-left: 3px solid var(--accent-primary); }
    .step-number { font-family: var(--font-mono); font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 8px; display: block; }
    .final-answer { margin-top: 40px; padding: 24px; background: rgba(16, 185, 129, 0.1); border: 1px solid var(--accent-success); border-radius: 12px; text-align: center; }

    /* Animations */
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    @media (max-width: 1024px) {
      .sidebar { width: 80px; padding: 16px; }
      .brand-text, .nav-text { display: none; }
      .brand { justify-content: center; padding: 0; }
      .nav-item { justify-content: center; }
      .modal-body { grid-template-columns: 1fr; }
      .problem-section { border-right: none; border-bottom: 1px solid var(--border-light); padding-bottom: 30px; margin-bottom: 30px; padding-right: 0; }
      .solution-section { padding-left: 0; }
    }
  </style>
</head>

<body>

  <aside class="sidebar">
    <div class="brand">
      <div class="brand-logo">⚡</div>
      <span class="brand-text">Innove</span>
    </div>

    <nav class="nav-menu">
      <button class="nav-item active" onclick="filterExercises('all')">
        <span class="nav-text">Todo</span>
      </button>
      <button class="nav-item" onclick="filterExercises('dc')">
        <span class="nav-text">DC Avanzado</span>
      </button>
      <button class="nav-item" onclick="filterExercises('ac')">
        <span class="nav-text">Régimen AC</span>
      </button>
      <button class="nav-item" onclick="filterExercises('machines')">
        <span class="nav-text">Máquinas</span>
      </button>
    </nav>
  </aside>

  <main class="main-content">
    <header class="header">
      <div class="header-content">
        <h1 class="h1">Análisis de Circuitos</h1>
        <p class="text-muted">Ejercicios de nivel examen final/oposición. Fuentes controladas, transitorios complejos y máquinas.</p>
      </div>
      <div class="header-actions">
        <button class="theme-btn" onclick="toggleTheme()">☀</button>
      </div>
    </header>

    <div class="exercise-grid" id="grid">
      </div>
  </main>

  <div class="modal-backdrop" id="modal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title-group">
          <h2 class="h2" id="modal-title">Título</h2>
          <span class="text-muted font-mono" id="modal-id">ID</span>
        </div>
        <button class="close-modal-btn" onclick="closeModal()">×</button>
      </div>
      <div class="modal-body">
        <div class="problem-section">
          <span class="text-muted font-mono text-sm uppercase">Enunciado</span>
          <div style="font-size: 1.1rem; margin-top: 16px; line-height: 1.7;" id="modal-problem"></div>
        </div>
        <div class="solution-section" id="modal-steps"></div>
      </div>
    </div>
  </div>

  <script>
    /* ============================================================
    DATABASE: 15 HIGH-LEVEL CIRCUIT PROBLEMS
    ============================================================
    */
    const exercises = [
      // --- DC AVANZADO (Based on Image 3) ---
      {
        id: "DC-01",
        category: "dc",
        topic: "Análisis de Mallas & Fuentes Dependientes",
        difficulty: "Hard",
        problem: "En un circuito con dos mallas, una fuente de corriente $I_A=2A$ está en la rama exterior izquierda y una fuente dependiente de tensión $2v_x$ está en la malla superior. Si $v_x$ es la caída de tensión en la resistencia de $1\\Omega$ compartida, determina la potencia suministrada por la fuente dependiente.",
        steps: [
          "Definimos corrientes de malla $i_1, i_2, i_3$. La presencia de fuentes de corriente impone restricciones o crea supermallas.",
          "Identificamos la variable de control: $v_x = (i_1 - i_2) \\cdot R$.",
          "Planteamos LVK en la supermalla que evita la fuente de corriente, incluyendo el término $2v_x$.",
          "Resolvemos el sistema lineal resultante para hallar las corrientes.",
          "Calculamos la tensión en bornes de la fuente dependiente y aplicamos $P = V \\cdot I$."
        ],
        solution: "$$ P_{dep} = 80 \\text{ W (Suministrada)} $$"
      },
      {
        id: "DC-02",
        category: "dc",
        topic: "Supernodos",
        difficulty: "Hard",
        problem: "Calcula la tensión nodal $V_2$ en un circuito que contiene una fuente de tensión flotante de 10V entre los nodos 2 y 3, y una fuente de corriente dependiente $0.5 V_1$ conectada al nodo 1.",
        steps: [
          "Identificamos el Supernodo entre los nodos 2 y 3 debido a la fuente de tensión flotante.",
          "Ecuación de restricción: $V_2 - V_3 = 10$.",
          "LCK en el nodo 1: Involucra la fuente dependiente $0.5 V_1$.",
          "LCK en el Supernodo (2,3): Suma de corrientes salientes = 0.",
          "Resolvemos el sistema de 3x3."
        ],
        solution: "$$ V_2 = 14.5 \\text{ V} $$"
      },
      {
        id: "DC-03",
        category: "dc",
        topic: "Teorema de Thevenin Generalizado",
        difficulty: "Extreme",
        problem: "Halla el equivalente de Thevenin visto desde los terminales A-B de un circuito que contiene solo resistencias y una fuente dependiente de corriente $i = 3v_{ab}$. No hay fuentes independientes.",
        steps: [
          "Al no haber fuentes independientes, $V_{th} = 0$.",
          "Para hallar $R_{th}$, debemos excitar el circuito con una fuente de prueba $V_p = 1V$ en A-B.",
          "Calculamos la corriente $I_p$ que entra por la fuente de prueba.",
          "La variable de control $v_{ab}$ es ahora 1V, por lo que la fuente dependiente vale 3A.",
          "Resolvemos el circuito por nodos para hallar $I_p$. $R_{th} = 1 / I_p$."
        ],
        solution: "$$ V_{th}=0V, \\; R_{th} = 2.5 \\Omega $$"
      },
      {
        id: "DC-04",
        category: "dc",
        topic: "Máxima Transferencia de Potencia",
        difficulty: "Hard",
        problem: "Determine el valor de $R_L$ para máxima transferencia de potencia en un circuito puente desbalanceado alimentado por 24V.",
        steps: [
          "Retiramos $R_L$ y calculamos $V_{th}$ (tensión a circuito abierto) entre los terminales.",
          "Pasivamos las fuentes (cortocircuito a la de 24V) para hallar $R_{th}$.",
          "Observamos que al cortocircuitar la entrada, las resistencias del puente quedan en combinaciones paralelo-serie.",
          "La condición de máxima potencia es $R_L = R_{th}$."
        ],
        solution: "$$ R_L = 6.4 \\Omega, \\; P_{max} = 15W $$"
      },

      // --- AC AVANZADO (Based on Image 1) ---
      {
        id: "AC-01",
        category: "ac",
        topic: "Análisis Nodal con Fasores",
        difficulty: "Hard",
        problem: "Dado el circuito de la figura con fuentes $V_A=20\\angle 10^\\circ$ y $V_B=40\\angle 30^\\circ$, impedancias $Z_L=j5, Z_C=-j10, R=10$. Calcula la tensión en el nodo central usando el método de nodos.",
        steps: [
          "Convertimos todas las fuentes y componentes al dominio fasorial.",
          "Planteamos la LCK en el nodo central $V_x$: $\\frac{V_x - V_A}{R+jX_L} + \\frac{V_x - V_B}{jX_L} + \\dots = 0$.",
          "Agrupamos términos de $V_x$ (admitancias propias) y fuentes (admitancias mutuas).",
          "Operamos con números complejos para despejar $V_x$."
        ],
        solution: "$$ V_x = 28.4 \\angle 15.2^\\circ \\text{ V} $$"
      },
      {
        id: "AC-02",
        category: "ac",
        topic: "Potencia Compleja y Balance",
        difficulty: "Hard",
        problem: "Calcula las potencias P, Q y S suministradas por la fuente de tensión $V_A$ en el problema anterior.",
        steps: [
          "Hallamos la corriente que sale de la fuente $I_A = (V_A - V_{nodo}) / Z_{rama}$.",
          "Calculamos la potencia compleja $S = V_A \\cdot I_A^*$.",
          "Separamos parte real ($P$) e imaginaria ($Q$).",
          "Verificamos si la fuente entrega o absorbe potencia según el signo de la parte real."
        ],
        solution: "$$ S = 450 + j120 \\text{ VA} $$"
      },
      {
        id: "AC-03",
        category: "ac",
        topic: "Teorema de Millman AC",
        difficulty: "Medium",
        problem: "Tres ramas en paralelo conectan los nodos A y B. Rama 1: $10\\angle 0^\\circ V, 2\\Omega$. Rama 2: $20\\angle 90^\\circ V, -j4\\Omega$. Rama 3: $j5\\Omega$. Halla $V_{AB}$.",
        steps: [
          "Aplicamos Millman: $V_{AB} = \\frac{\\sum V_k Y_k}{\\sum Y_k}$.",
          "Admitancias: $Y_1 = 0.5$, $Y_2 = 1/(-j4) = j0.25$, $Y_3 = 1/(j5) = -j0.2$.",
          "Numerador: $10(0.5) + (j20)(j0.25) + 0 = 5 - 5 = 0$.",
          "Interpretación: Las corrientes inyectadas se cancelan."
        ],
        solution: "$$ V_{AB} = 0 \\text{ V} $$"
      },
      {
        id: "AC-04",
        category: "ac",
        topic: "Resonancia Paralelo RLC",
        difficulty: "Hard",
        problem: "Un circuito RLC paralelo tiene $R=1k\\Omega, L=10mH, C=10\\mu F$. Halla la frecuencia de resonancia y el factor de calidad Q.",
        steps: [
          "Frecuencia angular resonante ideal: $\\omega_0 = \\frac{1}{\\sqrt{LC}}$.",
          "$\\omega_0 = \\frac{1}{\\sqrt{10^{-2} \\cdot 10^{-5}}} = \\frac{1}{\\sqrt{10^{-7}}} = 3162$ rad/s.",
          "Factor de calidad paralelo: $Q = R \\sqrt{C/L}$.",
          "$Q = 1000 \\sqrt{10^{-5}/10^{-2}} = 1000 \\sqrt{10^{-3}} = 31.6$."
        ],
        solution: "$$ f_0 = 503 \\text{ Hz}, \\; Q = 31.6 $$"
      },
      {
        id: "AC-05",
        category: "ac",
        topic: "Corrección Factor de Potencia",
        difficulty: "Medium",
        problem: "Una carga industrial consume 50kW con un f.d.p. de 0.6 en retraso a 230V. Calcula la capacidad necesaria para corregirlo a 0.95 en retraso (50Hz).",
        steps: [
          "Ángulo inicial $\\phi_1 = \\arccos(0.6)$, final $\\phi_2 = \\arccos(0.95)$.",
          "Potencia reactiva actual $Q_1 = P \\tan \\phi_1$. Nueva $Q_2 = P \\tan \\phi_2$.",
          "$Q_c = Q_1 - Q_2$ (Reactiva que debe aportar el condensador).",
          "Fórmula capacidad: $C = \\frac{Q_c}{\\omega V^2}$."
        ],
        solution: "$$ C \\approx 3050 \\mu F $$"
      },

      // --- MÁQUINAS Y TRANSITORIOS (Based on Image 2) ---
      {
        id: "MAC-01",
        category: "machines",
        topic: "Motor DC Derivación (Shunt)",
        difficulty: "Extreme",
        problem: "Motor DC $U=230V$, $I_{absorbida}=85A$ a $n=1200$ rpm. $R_{ind}=0.15\\Omega, R_{exc}=184\\Omega$. Calcula el par útil sabiendo que las pérdidas mecánicas son 800W.",
        steps: [
          "Corriente excitación $I_{exc} = U / R_{exc} = 230/184 = 1.25A$.",
          "Corriente inducido $I_a = I_{tot} - I_{exc} = 85 - 1.25 = 83.75A$.",
          "Fuerza Contraelectromotriz $E = U - I_a R_a = 230 - 83.75(0.15) \\approx 217.4V$.",
          "Potencia electromagnética $P_{ei} = E \\cdot I_a = 217.4 \\cdot 83.75 \\approx 18207W$.",
          "Potencia útil $P_u = P_{ei} - P_{mec} = 18207 - 800 = 17407W$.",
          "Par útil $M_u = P_u / \\omega = 17407 / (1200 \\cdot 2\\pi/60)$."
        ],
        solution: "$$ M_u = 138.5 \\text{ N}\\cdot\\text{m} $$"
      },
      {
        id: "MAC-02",
        category: "machines",
        topic: "Transformador (Modelo Gamma)",
        difficulty: "Hard",
        problem: "Trafo 50kVA 6600/220V. Ensayo cortocircuito: $u_{cc}=4\\%$, $P_{cc}=600W$. Calcula la caída de tensión ($\\%$) con una carga de 35kVA factor de potencia 0.8 inductivo.",
        steps: [
          "Índice de carga $C = S_{load}/S_{n} = 35/50 = 0.7$.",
          "Componente resistiva $\\epsilon_{Rcc} = P_{cc}/S_n = 600/50000 = 1.2\\%$.",
          "Componente reactiva $\\epsilon_{Xcc} = \\sqrt{\\epsilon_{cc}^2 - \\epsilon_{Rcc}^2} = \\sqrt{4^2 - 1.2^2} = 3.81\\%$.",
          "Fórmula Kapp: $\\Delta U \\approx C(\\epsilon_{Rcc}\\cos\\phi + \\epsilon_{Xcc}\\sin\\phi)$.",
          "$\\Delta U = 0.7(1.2 \\cdot 0.8 + 3.81 \\cdot 0.6)$."
        ],
        solution: "$$ \\Delta U \\% = 2.27 \\% $$"
      },
      {
        id: "MAC-03",
        category: "machines",
        topic: "Motor Inducción (Deslizamiento)",
        difficulty: "Medium",
        problem: "Motor asíncrono 4 polos, 50Hz. A plena carga gira a 1425 rpm. Calcula el deslizamiento y la frecuencia de las corrientes rotóricas.",
        steps: [
          "Velocidad síncrona $n_s = 60f/p = 60 \\cdot 50 / 2 = 1500$ rpm (pares de polos = 2).",
          "Deslizamiento $s = (n_s - n)/n_s = (1500 - 1425)/1500$.",
          "$s = 75/1500 = 0.05$ (5%).",
          "Frecuencia rotor $f_r = s \\cdot f_{estator} = 0.05 \\cdot 50$."
        ],
        solution: "$$ s = 5\\%, \\; f_r = 2.5 \\text{ Hz} $$"
      },
      {
        id: "TRA-01",
        category: "machines",
        topic: "Transitorio RLC Serie (Subamortiguado)",
        difficulty: "Extreme",
        problem: "Circuito RLC serie con $R=2\\Omega, L=1H, C=0.25F$. Condición inicial $v_c(0)=5V, i(0)=0$. Se cierra interruptor conectando fuente de 10V. Halla $v_c(t)$.",
        steps: [
          "Calculamos $\\alpha = R/2L = 1$. $\\omega_0 = 1/\\sqrt{LC} = 2$.",
          "$\\alpha < \\omega_0 \\Rightarrow$ Subamortiguado. $\\omega_d = \\sqrt{4-1} = \\sqrt{3}$.",
          "Forma: $v_c(t) = V_{final} + e^{-\\alpha t}(A \\cos \\omega_d t + B \\sin \\omega_d t)$.",
          "$V_{final} = 10$. En $t=0, v_c=5 \\Rightarrow 5 = 10 + A \\Rightarrow A=-5$.",
          "Derivada en $t=0$ es $i(0)/C = 0$. Obtenemos B.",
        ],
        solution: "$$ v_c(t) = 10 - e^{-t}(5\\cos(\\sqrt{3}t) + \\frac{5}{\\sqrt{3}}\\sin(\\sqrt{3}t)) $$"
      },
      {
        id: "TRA-02",
        category: "machines",
        topic: "Conmutación en t=0 (RC)",
        difficulty: "Hard",
        problem: "Un condensador se carga a través de 10k$\\Omega$ durante mucho tiempo. En $t=0$ se abre un interruptor dejando el condensador descargarse sobre una resistencia de 5k$\\Omega$ y otra de 20k$\\Omega$ en serie. Halla $V_c(t)$.",
        steps: [
          "Analizamos $t < 0$ (DC): El condensador es un circuito abierto. Hallamos $V_0$.",
          "Analizamos $t > 0$: El circuito cambia. La resistencia equivalente de descarga es $R_{eq} = 5k + 20k = 25k\\Omega$.",
          "Constante de tiempo $\\tau = R_{eq}C$.",
          "Respuesta natural: $v_c(t) = V_0 e^{-t/\\tau}$."
        ],
        solution: "$$ v_c(t) = V_0 e^{-t/(25000 C)} $$"
      },
      {
        id: "FIL-01",
        category: "ac",
        topic: "Filtro Pasivo Paso Banda",
        difficulty: "Medium",
        problem: "Diseña un circuito RLC serie que resuene a 10kHz y tenga un ancho de banda de 500Hz, usando un inductor de 10mH.",
        steps: [
          "Frecuencia central $f_0 = 10000$. $\\omega_0 = 2\\pi f_0$.",
          "Calculamos C: $\\omega_0^2 = 1/LC \\Rightarrow C = 1/(\\omega_0^2 L)$.",
          "Factor de calidad requerido $Q = f_0 / BW = 10000/500 = 20$.",
          "En RLC serie, $Q = \\omega_0 L / R$. Despejamos R.",
          "$R = \\omega_0 L / 20$."
        ],
        solution: "$$ C \\approx 25.3 nF, \\; R \\approx 31.4 \\Omega $$"
      }
    ];

    /* ============================================================
    APP LOGIC
    ============================================================
    */
    const modal = document.getElementById('modal');
    const grid = document.getElementById('grid');
    let currentFilter = 'all';

    function renderGrid(data) {
      grid.innerHTML = data.map((ex, index) => `
        <article class="exercise-card" style="animation-delay: ${index * 0.05}s" onclick="openModal('${ex.id}')">
          <div class="card-header">
            <div class="card-badges">
              <span class="badge badge-diff-${ex.difficulty === 'Extreme' ? 'extreme' : 'hard'}">${ex.difficulty}</span>
              <span class="badge badge-topic">${ex.topic}</span>
            </div>
            <span class="card-id font-mono text-muted text-sm">${ex.id}</span>
          </div>
          <div class="card-body">
            <div class="problem-preview">${ex.problem}</div>
          </div>
          <div class="card-footer">
            <span>Ver Resolución &rarr;</span>
          </div>
        </article>
      `).join('');

      if (window.MathJax) MathJax.typesetPromise([grid]);
    }

    function openModal(id) {
      const ex = exercises.find(e => e.id === id);
      if (!ex) return;

      document.getElementById('modal-title').textContent = ex.topic;
      document.getElementById('modal-id').textContent = ex.id;
      document.getElementById('modal-problem').innerHTML = ex.problem;

      const stepsContainer = document.getElementById('modal-steps');
      stepsContainer.innerHTML = '<span class="text-muted font-mono text-sm uppercase">Estrategia de Solución</span><br><br>';

      ex.steps.forEach((step, i) => {
        stepsContainer.innerHTML += `
          <div class="step-card" style="animation-delay: ${i * 0.1}s">
            <span class="step-number">PASO ${i + 1}</span>
            <div style="line-height: 1.6;">${step}</div>
          </div>
        `;
      });

      stepsContainer.innerHTML += `
        <div class="final-answer">
          <span class="text-accent-success font-bold uppercase text-sm mb-2 block">Resultado</span>
          <div style="font-size: 1.25rem;">${ex.solution}</div>
        </div>
      `;

      modal.classList.add('active');
      if (window.MathJax) MathJax.typesetPromise([modal]);
    }

    function closeModal() {
      modal.classList.remove('active');
    }

    function filterExercises(cat) {
      currentFilter = cat;
      document.querySelectorAll('.nav-item').forEach(btn => btn.classList.remove('active'));
      event.currentTarget.classList.add('active');
      const filtered = cat === 'all' ? exercises : exercises.filter(e => e.category === cat);
      renderGrid(filtered);
    }

    function toggleTheme() {
      const html = document.documentElement;
      html.setAttribute('data-theme', html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark');
    }

    modal.addEventListener('click', (e) => {
      if (e.target === modal) closeModal();
    });

    // Initial Render
    renderGrid(exercises);

  </script>
</body>
</html>
