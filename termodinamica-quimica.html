
<!DOCTYPE html>
<html lang="es" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Innove | Termodin√°mica UPC</title>
    
    <!-- FONTS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@500;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- TAILWIND -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
              display: ['Space Grotesk', 'sans-serif'],
              mono: ['JetBrains Mono', 'monospace'],
            },
            colors: {
              brand: {
                50: '#fff1f2',
                100: '#ffe4e6',
                500: '#f43f5e', // Rose
                600: '#e11d48',
                900: '#881337',
              },
              dark: {
                bg: '#050505',
                card: '#111111',
                sidebar: '#0a0a0a',
                border: 'rgba(255, 255, 255, 0.08)',
              }
            }
          }
        }
      }
    </script>

    <!-- MATHJAX -->
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$']],
          processEscapes: true,
          tags: 'ams'
        },
        svg: {
          fontCache: 'global'
        }
      };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        /* Animations */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .animate-fadeInUp { animation: fadeInUp 0.6s ease-out backwards; }
        .animate-slideDown { animation: slideDown 0.6s ease-out; }
        .animate-slideInRight { animation: slideInRight 0.5s ease-out backwards; }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #334155;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/"
  }
}
</script>
</head>
<body class="bg-slate-50 text-slate-900 dark:bg-dark-bg dark:text-white transition-colors duration-300 overflow-hidden h-screen flex font-sans">

    <!-- SIDEBAR -->
    <aside class="w-20 lg:w-[280px] h-full bg-white dark:bg-dark-sidebar border-r border-slate-200 dark:border-dark-border flex flex-col p-4 z-10 transition-all duration-300 shrink-0">
        <!-- Brand -->
        <div class="flex items-center gap-3 mb-10 px-2 justify-center lg:justify-start">
            <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-brand-500 to-brand-600 flex items-center justify-center text-white font-bold text-xl shadow-lg shadow-brand-500/30">
                $\Delta$
            </div>
            <span class="hidden lg:block font-display text-xl font-bold tracking-tight">Termo UPC</span>
        </div>

        <!-- Navigation -->
        <nav class="flex flex-col gap-2 flex-1 overflow-y-auto" id="nav-container">
            <!-- Generated by JS -->
        </nav>

        <!-- Footer Stats -->
        <div class="hidden lg:block mt-auto pt-6 border-t border-slate-200 dark:border-dark-border">
            <div class="bg-slate-100 dark:bg-white/5 p-4 rounded-xl">
                <div class="flex justify-between mb-2 text-sm font-medium">
                    <span class="text-slate-500 dark:text-slate-400">Ejercicios</span>
                    <span class="text-brand-600 dark:text-brand-500" id="progress-text">0/0</span>
                </div>
                <div class="w-full h-1.5 bg-slate-200 dark:bg-white/10 rounded-full overflow-hidden">
                    <div class="h-full w-0 bg-brand-500 rounded-full transition-all duration-500" id="progress-bar"></div>
                </div>
            </div>
        </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="flex-1 h-full overflow-y-auto p-5 md:p-10 relative scroll-smooth" id="main-scroll">
        
        <!-- Header -->
        <header class="flex justify-between items-end mb-10 animate-slideDown">
            <div>
                <h1 class="font-display text-3xl md:text-4xl font-bold mb-2 text-slate-900 dark:text-white">
                    Termodin√°mica 295024
                </h1>
                <p class="text-slate-500 dark:text-slate-400 max-w-2xl leading-relaxed">
                    Ejercicios nivel examen con c√°lculo diferencial e integral.
                </p>
            </div>
            
            <button 
                id="theme-toggle"
                class="w-12 h-12 rounded-xl border border-slate-200 dark:border-dark-border flex items-center justify-center text-xl hover:bg-slate-100 dark:hover:bg-white/5 transition-colors"
                aria-label="Toggle Theme"
            >
                ‚òÄÔ∏è
            </button>
        </header>

        <!-- Mobile Filters -->
        <div class="flex lg:hidden gap-3 mb-8 overflow-x-auto pb-2 no-scrollbar" id="mobile-filters">
             <!-- Generated by JS -->
        </div>

        <!-- Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 pb-20" id="exercise-grid">
             <!-- Generated by JS -->
        </div>
    </main>

    <!-- MODAL -->
    <div id="modal-backdrop" class="fixed inset-0 bg-slate-900/40 dark:bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 md:p-8 transition-all duration-300 opacity-0 invisible pointer-events-none">
        <div id="modal-content" class="w-full max-w-5xl h-[90vh] bg-white dark:bg-[#0f0f0f] rounded-3xl shadow-2xl flex flex-col overflow-hidden border border-slate-200 dark:border-dark-border transition-all duration-300 scale-95 translate-y-10">
            
            <!-- Modal Header -->
            <div class="px-8 py-6 border-b border-slate-200 dark:border-dark-border flex justify-between items-center bg-slate-50 dark:bg-dark-card shrink-0">
                <div>
                    <h2 id="modal-title" class="font-display text-2xl font-bold text-slate-900 dark:text-white mb-1">
                        <!-- Title -->
                    </h2>
                    <span id="modal-id" class="font-mono text-sm text-brand-600 dark:text-brand-400">
                        <!-- ID -->
                    </span>
                </div>
                <button 
                    onclick="closeModal()"
                    class="w-10 h-10 rounded-full bg-slate-200 dark:bg-white/10 text-slate-500 dark:text-slate-400 flex items-center justify-center hover:bg-brand-500 hover:text-white hover:rotate-90 transition-all duration-300"
                >
                    ‚úï
                </button>
            </div>

            <!-- Modal Body -->
            <div class="flex-1 overflow-y-auto p-6 md:p-10 grid grid-cols-1 lg:grid-cols-2 gap-10">
                
                <!-- Problem Section -->
                <div class="lg:border-r border-slate-200 dark:border-dark-border lg:pr-10">
                    <span class="text-xs font-mono font-bold text-brand-600 dark:text-brand-400 uppercase tracking-widest mb-4 block">
                        Enunciado
                    </span>
                    <div id="modal-problem" class="text-lg md:text-xl leading-relaxed text-slate-800 dark:text-slate-200 font-medium">
                        <!-- Problem Text -->
                    </div>
                    
                    <div class="mt-8 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-900/30 rounded-xl">
                        <p class="text-sm text-blue-800 dark:text-blue-300 flex gap-2">
                            <span>‚à´</span> 
                            <span>
                                <strong>Tip Matem√°tico:</strong> Recuerda que $dH = dU + d(PV)$ y las relaciones de Maxwell $(\partial T/\partial V)_S = -(\partial P/\partial S)_V$.
                            </span>
                        </p>
                    </div>
                </div>

                <!-- Solution Section -->
                <div>
                    <span class="text-xs font-mono font-bold text-brand-600 dark:text-brand-400 uppercase tracking-widest mb-6 block">
                        Desarrollo
                    </span>
                    
                    <div id="modal-steps" class="flex flex-col gap-4">
                        <!-- Steps injected here -->
                    </div>

                    <div class="mt-8 p-6 bg-emerald-50 dark:bg-emerald-500/10 border border-emerald-200 dark:border-emerald-500/30 rounded-xl text-center">
                        <span class="text-xs font-bold text-emerald-600 dark:text-emerald-400 uppercase tracking-widest mb-2 block">
                            Resultado
                        </span>
                        <div id="modal-solution" class="text-2xl font-display font-bold text-emerald-700 dark:text-emerald-400">
                            <!-- Solution -->
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- LOGIC -->
    <script>
        // --- DATA ---
        const exercises = [
            // ==========================================
            // PARCIAL 1 (PVT, 1er Principio, Calorimetr√≠a)
            // ==========================================
            {
                id: "P1-001", category: "parcial1", topic: "Ecuaci√≥n de Estado (Diferenciales)", difficulty: "Hard",
                problem: "Para una sustancia paramagn√©tica, se cumple que $\\alpha = 1/T$ y $\\kappa_T = 1/P$. Obtenga la ecuaci√≥n t√©rmica de estado $f(P,V,T)=0$ integrando la diferencial exacta $dV$.",
                steps: [
                    "Definici√≥n diferencial exacta: $dV = (\\frac{\\partial V}{\\partial T})_P dT + (\\frac{\\partial V}{\\partial P})_T dP$.",
                    "Sustituimos coeficientes: $dV = (V\\alpha) dT - (V\\kappa_T) dP$.",
                    "Separaci√≥n de variables: $\\frac{dV}{V} = \\alpha dT - \\kappa_T dP$.",
                    "Sustituimos funciones dadas: $\\frac{dV}{V} = \\frac{dT}{T} - \\frac{dP}{P}$.",
                    "Integramos: $\\ln V = \\ln T - \\ln P + \\ln R$ (cte integraci√≥n).",
                    "Propiedades logs: $\\ln V = \\ln(\\frac{RT}{P})$.",
                    "Despejamos: $PV = RT$."
                ],
                solution: "$$ PV = RT $$"
            },
            {
                id: "P1-002", category: "parcial1", topic: "Trabajo Gas Van der Waals", difficulty: "Hard",
                problem: "Calcule el trabajo realizado por un gas de Van der Waals $(P + a/v^2)(v-b) = RT$ al expandirse isot√©rmicamente y reversiblemente desde $v_1$ a $v_2$.",
                steps: [
                    "Expresi√≥n presi√≥n: $P = \\frac{RT}{v-b} - \\frac{a}{v^2}$.",
                    "Trabajo espec√≠fico: $w = \\int_{v_1}^{v_2} P dv$.",
                    "$w = \\int_{v_1}^{v_2} (\\frac{RT}{v-b} - \\frac{a}{v^2}) dv$.",
                    "Integrales inmediatas: $\\int \\frac{dx}{x-b} = \\ln(x-b)$ y $\\int -x^{-2} dx = x^{-1}$.",
                    "$w = RT[\\ln(v-b)]_{v_1}^{v_2} + [\\frac{a}{v}]_{v_1}^{v_2}$.",
                    "$w = RT \\ln(\\frac{v_2-b}{v_1-b}) + a(\\frac{1}{v_2} - \\frac{1}{v_1})$."
                ],
                solution: "$$ w = RT \\ln(\\frac{v_2-b}{v_1-b}) + a(\\frac{1}{v_2} - \\frac{1}{v_1}) $$"
            },
            {
                id: "P1-003", category: "parcial1", topic: "Capacidad Calor√≠fica Variable", difficulty: "Hard",
                problem: "Calcule el cambio de entalp√≠a $\\Delta h$ para un gas ideal si $C_p(T) = A + BT + CT^{-2}$ calentado de $T_1$ a $T_2$.",
                steps: [
                    "Para gas ideal $dh = C_p dT$.",
                    "$\\Delta h = \\int_{T_1}^{T_2} (A + BT + CT^{-2}) dT$.",
                    "Integramos t√©rmino a t√©rmino.",
                    "$\\Delta h = A(T_2-T_1) + \\frac{B}{2}(T_2^2 - T_1^2) - C(\\frac{1}{T_2} - \\frac{1}{T_1})$."
                ],
                solution: "$$ \\Delta h = A\\Delta T + \\frac{B}{2}\\Delta (T^2) - C\\Delta(T^{-1}) $$"
            },
            {
                id: "P1-004", category: "parcial1", topic: "Compresibilidad Isot√©rmica", difficulty: "Hard",
                problem: "Demuestre que para un gas de Van der Waals, $\\kappa_T = \\frac{v^2 (v-b)^2}{RT v^3 - 2a(v-b)^2}$.",
                steps: [
                    "Definici√≥n: $\\kappa_T = -\\frac{1}{v} (\\frac{\\partial v}{\\partial P})_T$.",
                    "Por propiedad c√≠clica: $(\\frac{\\partial v}{\\partial P})_T = 1 / (\\frac{\\partial P}{\\partial v})_T$.",
                    "Derivamos P respecto v: $P = \\frac{RT}{v-b} - \\frac{a}{v^2}$.",
                    "$(\\frac{\\partial P}{\\partial v})_T = -\\frac{RT}{(v-b)^2} + \\frac{2a}{v^3}$.",
                    "Denominador com√∫n: $\\frac{-RT v^3 + 2a(v-b)^2}{v^3 (v-b)^2}$.",
                    "Invertimos y multiplicamos por $-1/v$."
                ],
                solution: "$$ \\text{Ver desarrollo} $$"
            },
            {
                id: "P1-005", category: "parcial1", topic: "Proceso Politr√≥pico", difficulty: "Hard",
                problem: "Deduza la expresi√≥n del trabajo para un proceso politr√≥pico $PV^n = C$ con $n \\neq 1$ entre estados 1 y 2.",
                steps: [
                    "$W = \\int_1^2 P dV$. Sustituimos $P = C V^{-n}$.",
                    "$W = C \\int V^{-n} dV = C [\\frac{V^{-n+1}}{-n+1}]_1^2$.",
                    "$W = \\frac{C V_2^{1-n} - C V_1^{1-n}}{1-n}$.",
                    "Como $C = P_2 V_2^n = P_1 V_1^n$, sustituimos en cada t√©rmino.",
                    "$W = \\frac{P_2 V_2^n V_2^{1-n} - P_1 V_1^n V_1^{1-n}}{1-n} = \\frac{P_2 V_2 - P_1 V_1}{1-n}$."
                ],
                solution: "$$ \\frac{P_2 V_2 - P_1 V_1}{1-n} $$"
            },
            {
                id: "P1-006", category: "parcial1", topic: "Resorte Lineal (Trabajo)", difficulty: "Medium",
                problem: "Un pist√≥n confina gas. Un resorte lineal ejerce fuerza $F = kx$. Presi√≥n $P = P_{atm} + CV$. Si el volumen cambia de $V_1$ a $V_2$, calcule el trabajo.",
                steps: [
                    "$P(V) = A + BV$. (Lineal en V).",
                    "$W = \\int_{V_1}^{V_2} (A + BV) dV$.",
                    "√Årea bajo un trapecio.",
                    "$W = P_{prom} (V_2 - V_1) = \\frac{P_1 + P_2}{2} (V_2 - V_1)$."
                ],
                solution: "$$ \\frac{(P_1+P_2)(V_2-V_1)}{2} $$"
            },
            {
                id: "P1-007", category: "parcial1", topic: "Entalp√≠a Tobera", difficulty: "Medium",
                problem: "Tobera adiab√°tica. Aire entra a $T_1$ despreciable velocidad, sale a $V_2$. Calcule $V_2$ asumiendo $C_p$ constante.",
                steps: [
                    "1er Principio Sistema Abierto: $h_1 + \\frac{V_1^2}{2} = h_2 + \\frac{V_2^2}{2}$.",
                    "Adiab√°tico $q=0$, sin trabajo $w=0$. $V_1 \\approx 0$.",
                    "$V_2 = \\sqrt{2(h_1 - h_2)} = \\sqrt{2 C_p (T_1 - T_2)}$."
                ],
                solution: "$$ \\sqrt{2 C_p \\Delta T} $$"
            },
            {
                id: "P1-008", category: "parcial1", topic: "Conducci√≥n Transitoria", difficulty: "Hard",
                problem: "Esfera radio $R$, conductividad $k$. Ecuaci√≥n diferencial de calor en coord. esf√©ricas (simetr√≠a radial).",
                steps: [
                    "Ley de Fourier vectorial: $\\vec{q} = -k \\nabla T$.",
                    "Conservaci√≥n energ√≠a: $\\nabla \\cdot \\vec{q} + \\dot{g} = \\rho C \\frac{\\partial T}{\\partial t}$.",
                    "Operador divergencia esf√©ricas: $\\frac{1}{r^2} \\frac{\\partial}{\\partial r} (r^2 \\frac{\\partial T}{\\partial r})$.",
                    "Ecuaci√≥n: $\\frac{1}{r^2} \\frac{\\partial}{\\partial r} (kr^2 \\frac{\\partial T}{\\partial r}) + \\dot{g} = \\rho C \\frac{\\partial T}{\\partial t}$."
                ],
                solution: "$$ \\text{Ecuaci√≥n de Difusi√≥n Esf√©rica} $$"
            },
            {
                id: "P1-009", category: "parcial1", topic: "Gas Real (Factor Z)", difficulty: "Medium",
                problem: "Demuestre que para un gas que sigue $Pv = ZRT$, el trabajo isot√©rmico es $W = RT \\int (Z/v) dv$.",
                steps: [
                    "$W = \\int P dv$.",
                    "Sustituir $P = ZRT/v$.",
                    "Como T es cte, $W = RT \\int_{v_1}^{v_2} \\frac{Z(v)}{v} dv$."
                ],
                solution: "$$ RT \\int \\frac{Z}{v} dv $$"
            },
            {
                id: "P1-010", category: "parcial1", topic: "Proceso C√≠clico", difficulty: "Medium",
                problem: "En un ciclo, $\\oint \\delta Q = 50$ kJ. Si $\\oint P dV = -10$ kJ (trabajo sobre sistema). ¬øEs posible?",
                steps: [
                    "1er Ley Ciclo: $\\oint \\delta Q - \\oint \\delta W = \\oint dU = 0$.",
                    "$\\oint \\delta Q = \\oint \\delta W$.",
                    "$50 \\neq -10$. Viola la 1¬™ Ley."
                ],
                solution: "$$ \\text{Imposible} $$"
            },

            // ==========================================
            // PARCIAL 2 (2do Principio, Entrop√≠a, Potenciales)
            // ==========================================
            {
                id: "P2-001", category: "parcial2", topic: "Relaci√≥n Maxwell (Gibbs)", difficulty: "Hard",
                problem: "Usando la energ√≠a libre de Gibbs $dg = vdP - sdT$, demuestre la relaci√≥n de Maxwell $(\\frac{\\partial v}{\\partial T})_P = -(\\frac{\\partial s}{\\partial P})_T$.",
                steps: [
                    "$dg$ es diferencial exacta $M dx + N dy$.",
                    "Aqu√≠ $M=v$ (conjugada de P) y $N=-s$ (conjugada de T).",
                    "Condici√≥n exactitud: $\\frac{\\partial M}{\\partial y} = \\frac{\\partial N}{\\partial x}$.",
                    "Derivada cruzada: $\\frac{\\partial v}{\\partial T}$ a $P$ constante.",
                    "Derivada cruzada: $\\frac{\\partial (-s)}{\\partial P}$ a $T$ constante.",
                    "Igualando: $(\\frac{\\partial v}{\\partial T})_P = -(\\frac{\\partial s}{\\partial P})_T$."
                ],
                solution: "$$ \\text{Q.E.D.} $$"
            },
            {
                id: "P2-002", category: "parcial2", topic: "Coeficiente Joule-Thomson", difficulty: "Hard",
                problem: "El coeficiente $\\mu_{JT} = (\\frac{\\partial T}{\\partial P})_h$. Demuestre que $\\mu_{JT} = \\frac{v}{C_p}(T\\alpha - 1)$.",
                steps: [
                    "Relaci√≥n c√≠clica: $(\\frac{\\partial T}{\\partial P})_h = -(\\frac{\\partial h}{\\partial P})_T / (\\frac{\\partial h}{\\partial T})_P$.",
                    "Denominador es $C_p$.",
                    "Numerador: ecuaci√≥n $dh = Tds + vdP$. Dividir por $dP$ a $T$ cte.",
                    "$(\\frac{\\partial h}{\\partial P})_T = T(\\frac{\\partial s}{\\partial P})_T + v$.",
                    "Usar Maxwell: $(\\frac{\\partial s}{\\partial P})_T = -(\\frac{\\partial v}{\\partial T})_P = -v\\alpha$.",
                    "Sustituir: $(\\frac{\\partial h}{\\partial P})_T = v - Tv\\alpha$.",
                    "Final: $\\mu_{JT} = -\\frac{v(1-T\\alpha)}{C_p} = \\frac{v}{C_p}(T\\alpha - 1)$."
                ],
                solution: "$$ \\frac{v}{C_p}(T\\alpha - 1) $$"
            },
            {
                id: "P2-003", category: "parcial2", topic: "Entrop√≠a Gas Ideal (Variable)", difficulty: "Hard",
                problem: "Calcule $\\Delta s$ integrando $ds = C_p \\frac{dT}{T} - R \\frac{dP}{P}$ con $C_p = A + BT$.",
                steps: [
                    "Integral 1: $\\int_{T_1}^{T_2} \\frac{A+BT}{T} dT = \\int (\\frac{A}{T} + B) dT$.",
                    "$= A \\ln(T_2/T_1) + B(T_2 - T_1)$.",
                    "Integral 2: $-R \\ln(P_2/P_1)$.",
                    "Total: $\\Delta s = A \\ln(\\frac{T_2}{T_1}) + B\\Delta T - R \\ln(\\frac{P_2}{P_1})$."
                ],
                solution: "$$ s_2 - s_1 $$"
            },
            {
                id: "P2-004", category: "parcial2", topic: "Ecuaci√≥n Clapeyron (Integraci√≥n)", difficulty: "Hard",
                problem: "Asumiendo $h_{fg}$ constante y vapor gas ideal ($v_g \\gg v_f$), integre la ec. Clapeyron $\\frac{dP}{dT} = \\frac{h_{fg}}{T v_{fg}}$ para hallar la curva de presi√≥n de vapor.",
                steps: [
                    "Aproximaci√≥n: $v_{fg} \\approx v_g = RT/P$.",
                    "Sustituir: $\\frac{dP}{dT} = \\frac{h_{fg}}{T (RT/P)} = \\frac{P h_{fg}}{R T^2}$.",
                    "Separar variables: $\\frac{dP}{P} = \\frac{h_{fg}}{R} \\frac{dT}{T^2}$.",
                    "Integrar: $\\ln P = -\\frac{h_{fg}}{R} \\frac{1}{T} + C$.",
                    "Forma dos puntos: $\\ln(\\frac{P_2}{P_1}) = \\frac{h_{fg}}{R} (\\frac{1}{T_1} - \\frac{1}{T_2})$."
                ],
                solution: "$$ \\text{Ec. Clausius-Clapeyron} $$"
            },
            {
                id: "P2-005", category: "parcial2", topic: "Exerg√≠a (Gouy-Stodola)", difficulty: "Medium",
                problem: "Calcule la irreversibilidad $I$ (trabajo perdido) en un proceso adiab√°tico con generaci√≥n de entrop√≠a $S_{gen}$ y temperatura ambiente $T_0$.",
                steps: [
                    "Balance Exerg√≠a: $W_{rev} = W_{util} + I$.",
                    "Teorema Gouy-Stodola: $I = T_0 S_{gen}$.",
                    "Si $S_{gen} = \\Delta S_{syst} + \\Delta S_{surr}$.",
                    "Para adiab√°tico $\\Delta S_{surr} = 0$, as√≠ $I = T_0 \\Delta S_{syst}$."
                ],
                solution: "$$ I = T_0 S_{gen} $$"
            },
            {
                id: "P2-006", category: "parcial2", topic: "Ciclo Diesel (Aire Est√°ndar)", difficulty: "Hard",
                problem: "Expresi√≥n eficiencia Diesel $\\eta$ en funci√≥n de relaci√≥n de compresi√≥n $r$ y relaci√≥n de corte $r_c$.",
                steps: [
                    "Definici√≥n: $\\eta = 1 - \\frac{q_{out}}{q_{in}}$.",
                    "$q_{out} = C_v(T_4 - T_1)$ (isocora). $q_{in} = C_p(T_3 - T_2)$ (isobara).",
                    "$\\eta = 1 - \\frac{C_v(T_4-T_1)}{C_p(T_3-T_2)} = 1 - \\frac{1}{\\gamma} \\frac{T_1(T_4/T_1 - 1)}{T_2(T_3/T_2 - 1)}$.",
                    "Usar relaciones isentr√≥picas $TV^{\\gamma-1} = cte$.",
                    "Resultado complejo: $1 - \\frac{1}{r^{\\gamma-1}} [\\frac{r_c^\\gamma - 1}{\\gamma(r_c - 1)}]$."
                ],
                solution: "$$ 1 - \\frac{1}{r^{\\gamma-1}} [\\frac{r_c^\\gamma - 1}{\\gamma(r_c - 1)}] $$"
            },
            {
                id: "P2-007", category: "parcial2", topic: "Energ√≠a Libre Helmholtz", difficulty: "Hard",
                problem: "Demuestre que la presi√≥n es la derivada parcial de la energ√≠a libre de Helmholtz $f$ respecto al volumen.",
                steps: [
                    "Definici√≥n: $f = u - Ts$.",
                    "Diferencial: $df = du - Tds - sdT$.",
                    "1a Ley: $du = Tds - Pdv$.",
                    "Sustituir: $df = (Tds - Pdv) - Tds - sdT = -Pdv - sdT$.",
                    "Por tanto, $(\\frac{\\partial f}{\\partial v})_T = -P$."
                ],
                solution: "$$ P = -(\\frac{\\partial f}{\\partial v})_T $$"
            },
            {
                id: "P2-008", category: "parcial2", topic: "Desigualdad Clausius", difficulty: "Medium",
                problem: "Para un ciclo irreversible, demuestre que $\\oint \\frac{\\delta Q}{T} < 0$.",
                steps: [
                    "Considerar m√°quina t√©rmica irreversible y una reversible entre mismas T.",
                    "Eficiencia $\\eta_{irrev} < \\eta_{rev}$.",
                    "$1 - Q_L/Q_H < 1 - T_L/T_H \\Rightarrow Q_L/Q_H > T_L/T_H$.",
                    "$\\frac{Q_H}{T_H} - \\frac{Q_L}{T_L} < 0$ (Signos: entran +, salen -).",
                    "Generalizando: $\\oint \\frac{\\delta Q}{T} = -S_{gen} < 0$."
                ],
                solution: "$$ -S_{gen} $$"
            },
            {
                id: "P2-009", category: "parcial2", topic: "Potencial Qu√≠mico", difficulty: "Hard",
                problem: "Defina potencial qu√≠mico $\\mu_i$ usando la Energ√≠a de Gibbs para un sistema multicomponente.",
                steps: [
                    "$G = G(T, P, n_1, n_2 ...)$.",
                    "$dG = -SdT + VdP + \\sum \\mu_i dn_i$.",
                    "$\\mu_i = (\\frac{\\partial G}{\\partial n_i})_{T,P,n_{j\\neq i}}$."
                ],
                solution: "$$ (\\frac{\\partial G}{\\partial n_i})_{T,P} $$"
            },
            {
                id: "P2-010", category: "parcial2", topic: "Ciclo Rankine con Recalentamiento", difficulty: "Hard",
                problem: "Plantee el c√°lculo de la eficiencia t√©rmica si hay dos etapas de turbina (Alta y Baja presi√≥n) con recalentamiento intermedio.",
                steps: [
                    "$w_{T,tot} = (h_1 - h_2) + (h_3 - h_4)$.",
                    "$q_{in} = (h_1 - h_{bomba}) + (h_3 - h_2)$.",
                    "$\\eta = w_{net} / q_{in} = (w_{T,tot} - w_P) / q_{in}$."
                ],
                solution: "$$ \\frac{(h_1-h_2)+(h_3-h_4)-w_p}{(h_1-h_w)+(h_3-h_2)} $$"
            }
        ];

        const filters = [
            { id: 'all', label: 'Todo', icon: 'üìö' },
            { id: 'parcial1', label: 'Parcial 1', icon: 'üìù' },
            { id: 'parcial2', label: 'Parcial 2', icon: 'üéì' },
        ];

        // --- STATE ---
        let currentFilter = 'all';
        let theme = 'light';

        // --- DOM ELEMENTS ---
        const navContainer = document.getElementById('nav-container');
        const mobileFilters = document.getElementById('mobile-filters');
        const gridContainer = document.getElementById('exercise-grid');
        const themeBtn = document.getElementById('theme-toggle');
        const modalBackdrop = document.getElementById('modal-backdrop');
        const modalContent = document.getElementById('modal-content');

        // --- INITIALIZATION ---
        function init() {
            renderNavigation();
            renderGrid();
            updateProgress();
            
            // Check local storage for theme preference
            if (localStorage.getItem('theme') === 'dark') {
                toggleTheme();
            }
        }

        // --- RENDER FUNCTIONS ---
        function renderNavigation() {
            // Desktop Sidebar
            navContainer.innerHTML = filters.map(f => `
                <button 
                    onclick="setFilter('${f.id}')"
                    class="flex items-center gap-3 px-4 py-3 rounded-xl font-medium transition-all duration-200 group w-full text-left
                    ${currentFilter === f.id 
                        ? 'bg-brand-50 text-brand-600 dark:bg-brand-500/10 dark:text-brand-500' 
                        : 'text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-white/5 hover:text-slate-900 dark:hover:text-white'}"
                >
                    <span class="text-lg opacity-80 group-hover:opacity-100 group-hover:scale-110 transition-transform">${f.icon}</span>
                    <span class="hidden lg:block">${f.label}</span>
                </button>
            `).join('');

            // Mobile Filters
            mobileFilters.innerHTML = filters.map(f => `
                <button
                    onclick="setFilter('${f.id}')"
                    class="px-4 py-2 rounded-full border text-sm font-medium whitespace-nowrap transition-all
                    ${currentFilter === f.id
                        ? 'bg-brand-600 border-brand-600 text-white shadow-lg shadow-brand-500/20'
                        : 'bg-white dark:bg-dark-card border-slate-200 dark:border-dark-border text-slate-500 dark:text-slate-400'}"
                >
                    ${f.label}
                </button>
            `).join('');
        }

        function renderGrid() {
            const filtered = currentFilter === 'all' 
                ? exercises 
                : exercises.filter(ex => ex.category === currentFilter);

            gridContainer.innerHTML = filtered.map((ex, idx) => {
                const diffColor = getDifficultyColor(ex.difficulty);
                return `
                <article 
                    onclick="openModal('${ex.id}')"
                    class="group bg-white dark:bg-dark-card border border-slate-200 dark:border-dark-border rounded-2xl p-6 flex flex-col cursor-pointer hover:-translate-y-1 hover:shadow-xl hover:border-slate-300 dark:hover:border-white/20 transition-all duration-300 animate-fadeInUp"
                    style="animation-delay: ${idx * 0.02}s"
                >
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex gap-2 flex-wrap">
                            <span class="px-2.5 py-1 rounded-md text-[10px] font-bold uppercase tracking-wider ${diffColor}">
                                ${ex.difficulty}
                            </span>
                            <span class="px-2.5 py-1 rounded-md text-[10px] font-bold uppercase tracking-wider bg-slate-100 text-slate-500 dark:bg-white/5 dark:text-slate-400 border border-slate-200 dark:border-white/10">
                                ${ex.category === 'parcial1' ? 'P1: 1ER PRINCIPIO' : 'P2: 2DO PRINCIPIO'}
                            </span>
                        </div>
                        <span class="font-mono text-xs text-slate-400">${ex.id}</span>
                    </div>

                    <div class="flex-1 mb-6">
                        <h3 class="font-display font-bold text-lg mb-2 text-slate-800 dark:text-slate-100">${ex.topic}</h3>
                        <div class="text-sm text-slate-600 dark:text-slate-400 line-clamp-3 leading-relaxed">
                            ${ex.problem}
                        </div>
                    </div>

                    <div class="pt-4 border-t border-slate-100 dark:border-white/5 flex justify-between items-center text-brand-600 dark:text-brand-400 font-semibold text-sm">
                        <span>Ver Desarrollo</span>
                        <span class="group-hover:translate-x-1 transition-transform">‚Üí</span>
                    </div>
                </article>
                `;
            }).join('');

            refreshMath();
        }

        function getDifficultyColor(diff) {
            switch (diff) {
                case 'Easy': return 'bg-emerald-100 text-emerald-700 dark:bg-emerald-500/10 dark:text-emerald-400';
                case 'Medium': return 'bg-amber-100 text-amber-700 dark:bg-amber-500/10 dark:text-amber-400';
                case 'Hard': return 'bg-rose-100 text-rose-700 dark:bg-rose-500/10 dark:text-rose-400';
                default: return 'bg-gray-100 text-gray-700';
            }
        }

        function updateProgress() {
            document.getElementById('progress-text').innerText = `0/${exercises.length}`;
        }

        // --- INTERACTION ---
        function setFilter(id) {
            currentFilter = id;
            renderNavigation();
            renderGrid();
        }

        // --- MODAL ---
        function openModal(id) {
            const ex = exercises.find(e => e.id === id);
            if(!ex) return;

            document.getElementById('modal-title').innerText = ex.topic;
            document.getElementById('modal-id').innerText = `ID: ${ex.id}`;
            document.getElementById('modal-problem').innerHTML = ex.problem;
            document.getElementById('modal-solution').innerHTML = ex.solution;

            const stepsContainer = document.getElementById('modal-steps');
            stepsContainer.innerHTML = ex.steps.map((step, i) => `
                <div class="p-5 bg-slate-50 dark:bg-white/5 rounded-xl border-l-4 border-brand-500 animate-slideInRight" style="animation-delay: ${i * 0.1}s">
                    <span class="text-xs font-mono text-slate-400 dark:text-slate-500 mb-2 block">PASO ${i + 1}</span>
                    <div class="text-slate-700 dark:text-slate-300">
                        ${step}
                    </div>
                </div>
            `).join('');

            modalBackdrop.classList.remove('opacity-0', 'invisible', 'pointer-events-none');
            modalContent.classList.remove('scale-95', 'translate-y-10');
            modalContent.classList.add('scale-100', 'translate-y-0');

            refreshMath();
        }

        function closeModal() {
            modalBackdrop.classList.add('opacity-0', 'invisible', 'pointer-events-none');
            modalContent.classList.remove('scale-100', 'translate-y-0');
            modalContent.classList.add('scale-95', 'translate-y-10');
        }

        // Close modal on backdrop click
        modalBackdrop.addEventListener('click', (e) => {
            if(e.target === modalBackdrop) closeModal();
        });

        // --- THEME ---
        themeBtn.addEventListener('click', toggleTheme);

        function toggleTheme() {
            const html = document.documentElement;
            if (html.classList.contains('dark')) {
                html.classList.remove('dark');
                localStorage.setItem('theme', 'light');
                themeBtn.innerText = '‚òÄÔ∏è';
            } else {
                html.classList.add('dark');
                localStorage.setItem('theme', 'dark');
                themeBtn.innerText = 'üåô';
            }
        }

        // --- MATHJAX ---
        function refreshMath() {
            if (window.MathJax && window.MathJax.typesetPromise) {
                setTimeout(() => {
                     window.MathJax.typesetPromise();
                }, 10);
            }
        }

        // Run
        init();

    </script>
</body>
</html>
